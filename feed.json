{
    "version": "https://jsonfeed.org/version/1",
    "title": "Guto@Site",
    "description": "",
    "home_page_url": "https://gutocarvalho.net",
    "feed_url": "https://gutocarvalho.net/feed.json",
    "user_comment": "",
    "author": {
        "name": "Guto Carvalho"
    },
    "items": [
        {
            "id": "https://gutocarvalho.net/dashboards-para-k8s/",
            "url": "https://gutocarvalho.net/dashboards-para-k8s/",
            "title": "Dashboards para K8S",
            "summary": "Quer usar Dashboards para o Kubernetes? Bora! Algumas opções bastante conhecidas Projetos&hellip;",
            "content_html": "<p>Quer usar Dashboards para o Kubernetes? Bora!</p>\n<p>Algumas opções bastante conhecidas</p>\n<ul>\n<li><a href=\"https://rancher.com/docs/rancher/v2.6/en/\">https://rancher.com/docs/rancher/v2.6/en/</a></li>\n<li><a href=\"https://github.com/kubernetes/dashboard\">https://github.com/kubernetes/dashboard</a></li>\n<li><a href=\"https://www.portainer.io\">https://www.portainer.io</a></li>\n<li><a href=\"https://www.weave.works/oss/scope\">https://www.weave.works/oss/scope</a></li>\n</ul>\n<p>Projetos promissores</p>\n<ul>\n<li><a href=\"https://octant.dev\">https://octant.dev</a></li>\n<li><a href=\"https://github.com/skooner-k8s/skooner\">https://github.com/skooner-k8s/skooner</a></li>\n<li><a href=\"https://kubevious.io\">https://kubevious.io</a> (esse é bem interessante)</li>\n</ul>\n<p>Para terminal</p>\n<ul>\n<li><a href=\"https://codeberg.org/hjacobs/kube-ops-view\">https://codeberg.org/hjacobs/kube-ops-view</a></li>\n<li><a href=\"https://k9scli.io\">https://k9scli.io</a></li>\n</ul>\n<p>Para seu desktop</p>\n<ul>\n<li><a href=\"https://k8slens.dev\">https://k8slens.dev</a></li>\n<li><a href=\"https://kubenav.io\">https://kubenav.io</a></li>\n</ul>\n<p>Para testar</p>\n<ul>\n<li><a href=\"https://github.com/smpio/kubernator\">https://github.com/smpio/kubernator</a></li>\n<li><a href=\"https://jeremykross.github.io/konstellate\">https://jeremykross.github.io/konstellate</a></li>\n</ul>\n<p>Gerador de relatórios de custos para AWS e GCP</p>\n<ul>\n<li><a href=\"https://codeberg.org/hjacobs/kube-resource-report\">https://codeberg.org/hjacobs/kube-resource-report</a></li>\n</ul>\n<p>[s]</p>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "MindNotes"
            ],
            "date_published": "2021-11-18T10:28:11-03:00",
            "date_modified": "2021-11-18T10:28:11-03:00"
        },
        {
            "id": "https://gutocarvalho.net/instalando-istio-via-helm-para-testes/",
            "url": "https://gutocarvalho.net/instalando-istio-via-helm-para-testes/",
            "title": "DROPS: Instalando ISTIO via helm para testes",
            "summary": "Aprendar a instalar o Istio via Helm em poucos passos. O Istio&hellip;",
            "content_html": "<p>Aprendar a instalar o Istio via Helm em poucos passos.</p>\n<hr>\n<p>O Istio é uma implementação de service mesh, falaremos oq é isso em outro post!</p>\n<h2 id=\"instalando\">Instalando</h2>\n<p>crie um diretório</p>\n<pre><code>$ mkdir istio &amp;&amp; cd istio\n</code></pre>\n<p>baixe o pacote</p>\n<pre><code>$ curl -L https://istio.io/downloadIstio | ISTIO_VERSION=1.11.4 TARGET_ARCH=x86_64 sh -\n</code></pre>\n<p>Crie o namespace</p>\n<pre><code>$ kubectl create namespace istio-system \n</code></pre>\n<p>Instale o pacote base (CRD’s)</p>\n<pre><code>$ helm install istio-base istio-1.11.4/manifests/charts/base -n istio-system\n</code></pre>\n<p>Instale o istiod (Services)</p>\n<pre><code>$ helm install istiod istio-1.11.4/manifests/charts/istio-control/istio-discovery -n istio-system\n</code></pre>\n<p>Instale o istio ingress (opcional)</p>\n<pre><code>$ helm install istio-ingress istio-1.11.4/manifests/charts/gateways/istio-ingress -n istio-system\n</code></pre>\n<p>Instale o istio egress (opcional)</p>\n<pre><code>$ helm install istio-egress istio-1.11.4/manifests/charts/gateways/istio-egress -n istio-system\n</code></pre>\n<h2 id=\"validando\">Validando</h2>\n<p>Verifique</p>\n<pre><code>$ kubectl get pods -n istio-system\n</code></pre>\n<p>Saída esperada</p>\n<pre><code>NAME                                    READY   STATUS    RESTARTS   AGE\nistio-egressgateway-6674469d89-zz4h8    1/1     Running   0          12m\nistio-ingressgateway-55cf46987b-5lcxj   1/1     Running   0          13m\nistiod-7556556fcc-7bcf8                 1/1     Running   0          13m\n</code></pre>\n<p>Verifique</p>\n<pre><code>$ kubectl get istio-io --all-namespaces\n</code></pre>\n<p>Saída esperada</p>\n<pre><code>NAMESPACE      NAME                                                         AGE\nistio-system   envoyfilter.networking.istio.io/metadata-exchange-1.10       13m\nistio-system   envoyfilter.networking.istio.io/metadata-exchange-1.11       13m\nistio-system   envoyfilter.networking.istio.io/metadata-exchange-1.9        13m\nistio-system   envoyfilter.networking.istio.io/stats-filter-1.10            13m\nistio-system   envoyfilter.networking.istio.io/stats-filter-1.11            13m\nistio-system   envoyfilter.networking.istio.io/stats-filter-1.9             13m\nistio-system   envoyfilter.networking.istio.io/tcp-metadata-exchange-1.10   13m\nistio-system   envoyfilter.networking.istio.io/tcp-metadata-exchange-1.11   13m\nistio-system   envoyfilter.networking.istio.io/tcp-metadata-exchange-1.9    13m\nistio-system   envoyfilter.networking.istio.io/tcp-stats-filter-1.10        13m\nistio-system   envoyfilter.networking.istio.io/tcp-stats-filter-1.11        13m\nistio-system   envoyfilter.networking.istio.io/tcp-stats-filter-1.9         13m\n</code></pre>\n<h2 id=\"removendo\">Removendo</h2>\n<p>Numa tacada só</p>\n<pre><code>$ helm uninstall istio-base istio-egress istio-ingress istiod -n istio-system\n</code></pre>\n<p>Saída esperada</p>\n<pre><code>release &quot;istio-base&quot; uninstalled\nrelease &quot;istio-egress&quot; uninstalled\nrelease &quot;istio-ingress&quot; uninstalled\nrelease &quot;istiod&quot; uninstalled\n</code></pre>\n<p>Removendo o namespace</p>\n<pre><code>$ kubectl delete namespace istio-system\n</code></pre>\n<pre><code>namespace &quot;istio-system&quot; deleted\n</code></pre>\n<p>Removendo CRDs</p>\n<pre><code>$ kubectl get crd | grep --color=never &#39;istio.io&#39; | awk &#39;{print $1}&#39;| xargs -n1 kubectl delete crd\n</code></pre>\n<p>Saída esperada</p>\n<pre><code>customresourcedefinition.apiextensions.k8s.io &quot;adapters.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;attributemanifests.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;authorizationpolicies.security.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;clusterrbacconfigs.rbac.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;destinationrules.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;envoyfilters.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;gateways.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;handlers.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;httpapispecbindings.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;httpapispecs.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;instances.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;istiooperators.install.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;peerauthentications.security.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;quotaspecbindings.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;quotaspecs.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;rbacconfigs.rbac.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;requestauthentications.security.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;rules.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;serviceentries.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;servicerolebindings.rbac.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;serviceroles.rbac.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;sidecars.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;telemetries.telemetry.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;templates.config.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;virtualservices.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;workloadentries.networking.istio.io&quot; deleted\ncustomresourcedefinition.apiextensions.k8s.io &quot;workloadgroups.networking.istio.io&quot; deleted\n</code></pre>\n<h2 id=\"refs\">Refs</h2>\n<ul>\n<li><a href=\"https://istio.io/latest/docs/setup/getting-started/\">https://istio.io/latest/docs/setup/getting-started/</a></li>\n<li><a href=\"https://istio.io/latest/docs/setup/install/\">https://istio.io/latest/docs/setup/install/</a></li>\n<li><a href=\"https://istio.io/latest/docs/setup/install/helm/\">https://istio.io/latest/docs/setup/install/helm/</a></li>\n</ul>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "Projetos",
                   "K8S",
                   "Drops"
            ],
            "date_published": "2021-11-08T16:29:04-03:00",
            "date_modified": "2021-11-08T16:32:24-03:00"
        },
        {
            "id": "https://gutocarvalho.net/dicas-sobre-quadros-e-canetas/",
            "url": "https://gutocarvalho.net/dicas-sobre-quadros-e-canetas/",
            "title": "Dicas sobre quadros e canetas!",
            "summary": "<p>Pessoal, seguem algumas dicas sobre quadros para escrever em casa.</p>\n",
            "content_html": "<p>Pessoal, seguem algumas dicas sobre quadros para escrever em casa.</p>\n\n<figure class=\"post__image\">Eu sou desses que tem vários quadros – para escrever com canetinha – em casa, tenho de vidro, de metal, de madeira, e outros tipos, eu gosto de escrever para lembrar das coisas, para deixar recados para as crianças, para deixar recados pra mim, para organizar atividades. Eu acho que os quadros sempre estiverem presentes na minha vida, eu não sei viver sem eles.<br><br><img loading=\"lazy\"  src=\"https://gutocarvalho.net/media/posts/72/quadro_vidro.jpg\" sizes=\"(min-width: 61.3125em) 50vw, 100vw\" srcset=\"https://gutocarvalho.net/media/posts/72/responsive/quadro_vidro-xs.jpg 300w ,https://gutocarvalho.net/media/posts/72/responsive/quadro_vidro-sm.jpg 480w ,https://gutocarvalho.net/media/posts/72/responsive/quadro_vidro-md.jpg 768w\"  alt=\"\" width=\"1280\" height=\"960\"></figure><br><br>Eu escrevo até nos espelhos :)</p>\n<div class=\"gallery-wrapper\"><div class=\"gallery\"  data-is-empty=\"false\" data-columns=\"2\">\n<figure class=\"gallery__item\"><a href=\"https://gutocarvalho.net/media/posts/72/gallery/espelho1-2.jpg\" data-size=\"960x1280\"><img loading=\"lazy\" src=\"https://gutocarvalho.net/media/posts/72/gallery/espelho1-2-thumbnail.jpg\" alt=\"\" width=\"768\" height=\"1024\"></a></figure>\n<figure class=\"gallery__item\"><a href=\"https://gutocarvalho.net/media/posts/72/gallery/espelho2-2.jpg\" data-size=\"960x1280\"><img loading=\"lazy\" src=\"https://gutocarvalho.net/media/posts/72/gallery/espelho2-2-thumbnail.jpg\" alt=\"\" width=\"768\" height=\"1024\"></a></figure>\n</div></div>\n<p><br>Usando tantos quadros, por tantos anos, especialmente de vidro, a gente acaba experimentando uma série de canetas e aprendendo sobre elas. <br><br>Fiz esse post para ajudar você a escolher o melhor tipo de caneta e quadro para sua casa/escritório.<br><br><strong>Canetas com ponta grossa ( traço de 2 a 5 mm )</strong><br><br>No quesito caneta com ponta grossa, eu gosto muito das canetas da <a href=\"https://www.compactor.com.br/marcadores-qb/\">compactor</a> para quadro branco, são excelentes, uso há cerca de dois anos, e virou minha caneta padrão devido a qualidade e custo vs benefício.<br><br></p>\n<figure class=\"post__image\"><img loading=\"lazy\"  src=\"https://gutocarvalho.net/media/posts/72/Screen-Shot-2021-11-05-at-12.35.11.png\" sizes=\"(min-width: 61.3125em) 50vw, 100vw\" srcset=\"https://gutocarvalho.net/media/posts/72/responsive/Screen-Shot-2021-11-05-at-12.35.11-xs.png 300w ,https://gutocarvalho.net/media/posts/72/responsive/Screen-Shot-2021-11-05-at-12.35.11-sm.png 480w ,https://gutocarvalho.net/media/posts/72/responsive/Screen-Shot-2021-11-05-at-12.35.11-md.png 768w\"  alt=\"\" width=\"562\" height=\"540\"></figure>\n<p>Elas funcionam muito bem para desenhar no geral, e no meu caso para rabiscar umas topologias, arquiteturas, redes, etc, ajuda muito no troubleshooting, na proposição de projetos e uso principalmente como \"lista de coisas a fazer\" :)<br><br>Ela está disponível nas cores azul, preta, vermelha, verde e rosa.<br><br>Sua ponta cônica é muito confortável e firme.<br><br>Oferece reservatório para recarga.<br><br><strong>Canetas com ponta fina ( traço de 1 a 2 mm )</strong></p>\n<p>Em alguns casos ponta grossa pode ser um problema, especialmente em quadros personalizados com pouco espaço para escrever, nestes quadros eu uso as canetas da <a href=\"https://www.staedtler.com/br/pt/produtos/marcador/marcador-para-quadro-branco/\">staedtler</a> lumocolor whiteboard, são maravilhosas.</p>\n<figure class=\"post__image\"><img loading=\"lazy\"  src=\"https://gutocarvalho.net/media/posts/72/Screen-Shot-2021-11-05-at-12.37.01.png\" sizes=\"(min-width: 61.3125em) 50vw, 100vw\" srcset=\"https://gutocarvalho.net/media/posts/72/responsive/Screen-Shot-2021-11-05-at-12.37.01-xs.png 300w ,https://gutocarvalho.net/media/posts/72/responsive/Screen-Shot-2021-11-05-at-12.37.01-sm.png 480w ,https://gutocarvalho.net/media/posts/72/responsive/Screen-Shot-2021-11-05-at-12.37.01-md.png 768w\"  alt=\"\" width=\"441\" height=\"431\"></figure>\n<p> </p>\n<p><strong>Exemplo de traço grosso</strong><br><br></p>\n<div class=\"gallery-wrapper\"><div class=\"gallery\"  data-is-empty=\"false\" data-columns=\"2\">\n<figure class=\"gallery__item\"><a href=\"https://gutocarvalho.net/media/posts/72/gallery/calendario_traco_grosso-3.jpg\" data-size=\"1280x960\"><img loading=\"lazy\" src=\"https://gutocarvalho.net/media/posts/72/gallery/calendario_traco_grosso-3-thumbnail.jpg\" alt=\"\" width=\"768\" height=\"576\"></a></figure>\n<figure class=\"gallery__item\"><a href=\"https://gutocarvalho.net/media/posts/72/gallery/semana_traco_grosso-4.jpg\" data-size=\"1280x960\"><img loading=\"lazy\" src=\"https://gutocarvalho.net/media/posts/72/gallery/semana_traco_grosso-4-thumbnail.jpg\" alt=\"\" width=\"768\" height=\"576\"></a></figure>\n</div></div>\n<p><strong>Exemplo de Traço fino</strong><br><br></p>\n<div class=\"gallery-wrapper\"><div class=\"gallery\"  data-is-empty=\"false\" data-columns=\"2\">\n<figure class=\"gallery__item\"><a href=\"https://gutocarvalho.net/media/posts/72/gallery/calendario_traco_fino.jpg\" data-size=\"1280x960\"><img loading=\"lazy\" src=\"https://gutocarvalho.net/media/posts/72/gallery/calendario_traco_fino-thumbnail.jpg\" alt=\"\" width=\"768\" height=\"576\"></a></figure>\n<figure class=\"gallery__item\"><a href=\"https://gutocarvalho.net/media/posts/72/gallery/semana_traco_fino.jpg\" data-size=\"1280x960\"><img loading=\"lazy\" src=\"https://gutocarvalho.net/media/posts/72/gallery/semana_traco_fino-thumbnail.jpg\" alt=\"\" width=\"768\" height=\"576\"></a></figure>\n</div></div>\n<p><br>Yeah, minha letra é complexa e exótica.<br><br><strong>Outras canetas que recomendo</strong><br><br>Já usei as canetas <a href=\"http://www.pilotpen.com.br/produtos/marc-wbma-v-board-master-para-quadro-branco/\">Pilot Board Master</a> recarregáveis, mais parei devido ao preço e a dificuldade de achar as recargas, fora que a recarga tava o preço da caneta, ai não compensava. Apesar de terem viajado no preço, são canetas boas , tem o traço grosso de 2 a 5 mm, são realmente bem bacanas especialmente para dar aulas, usei de 2013 a 2019 em especial, falando dessa marca e modelo.</p>\n<p>Recentemente descobri também as canetas da Faber Castell, são equivalentes ao Pilot Board Master e a Compactor.</p>\n<p>Quando as crianças querem desenhar eu compro uns kits de 4 canetas da bic, keep ou pilot modelo wbm-7, são mais baratas e viáveis para eles, do contrario eles acabam com minhas canetas pessoais em uma tarde.</p>\n<p><strong>Falando de Quadros</strong><br><br>Eu gosto desses quadros personalizados, eles normalmente são de metal, madeira ou até papelão, contudo hoje em dia eu prefiro quadros de vidro, vou até tentar refazer esses dois da foto acima em vidro com adesivagem similar.<br><br><strong><span style=\"color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit;\">Quadros de vidro tem muitas vantagens, dentre elas:</span></strong></p>\n<p>- São mais bonitos<br>- São mais discretos<br>- Eles encaixam melhor na sua decoração<br>- São fáceis de limpar<br>- São simples de instalar<br>- Qualquer vidraçaria faz<br><br><strong>Alguns cuidados ao comprar na vidraçaria</strong><br><br>- Sempre use vidro temperado, especialmente se tem crianças em casa<br>- A espessura mínima é 4mm, mas eu uso de 8mm pra frente<br>- Instale encostado na parede, ele fica mais firme e seguro, sendo mais difícil quebrar<br><br><strong>Opções no mercado</strong></p>\n<p>O pessoal da Easy Office oferece bons quadros de vidro, inclusive magnéticos, algo que não dá para pedir na vidraçaria. Os meus eu comprei na Kalunga.<br><br><strong>Custo vs Benefício dos quadros</strong><br><br>Os quadros de madeira são mais baratos, mas essencialmente tem vida útil menor e com o tempo eles perdem aquela camada de \"verniz\", deixando tudo bem dificil de apagar.<br><br>Os quadros de metal são interessantes, mas geralmente eles tem um tema, é difícil achar um todo branco para comprar, e nas minhas muitas mudanças vários amassaram as pontinhas.<br><br><strong>Dicas soltas</strong><br><br>Não use apagador, prefira panos de microfibra, funciona 1000x melhor.<br><br>Se sua parede é branca, e se instalar encostado na parede, nem precisará de fundo branco adesivado ou pintado – apesar de recomendar para dar uma uniformidade na cor.<br><br>Se for instalar afastado da parede com pinos de 5cm o 10cm, o fundo branco pintado ou adesivado é fundamental para conseguir ler o que escreveu no quadro. Mas é dificil limpar na parte de trás e se apoiar nele pode quebrar, tem que temperar e usar de 8 a 10mm.<br><br><strong>Quadros que nem vemos</strong><br><br>Eu escrevo nas janelas, vidros da varanda e até nos espelhos, essas canetinhas são muito funcionais e uma simples janela pode virar um quadro para deixar uma mensagem, um lembrete ou simplesmente para desenhar e soltar sua criatividade.</p>\n<p><strong>Dicas Kids</strong><br><br>Como as canetas são relativamente caras, especialmente se tratando de crianças, eles acabam com a tinta de 1 kit em uma tarde. Pensando nisso, no quarto das crianças eu pintei em uma parede um quadro usando tinta \"lousa &amp; cor\" da suvinil.</p>\n<figure class=\"post__image\"><img loading=\"lazy\"  src=\"https://gutocarvalho.net/media/posts/72/lousa_kids.jpg\" sizes=\"(min-width: 61.3125em) 50vw, 100vw\" srcset=\"https://gutocarvalho.net/media/posts/72/responsive/lousa_kids-xs.jpg 300w ,https://gutocarvalho.net/media/posts/72/responsive/lousa_kids-sm.jpg 480w ,https://gutocarvalho.net/media/posts/72/responsive/lousa_kids-md.jpg 768w\"  alt=\"\" width=\"960\" height=\"1280\"></figure><br><br>Esse é o quarto/brinquedoteca/sala de estudo aq de casa, quando as crianças vem pra cá usam esse espaço para tudo, inclusive para desenhar.</p>\n<p>Nessa parede eles podem escrever com giz normal ou giz líquido. As canetinhas de giz líquido duram bem mais que as canetinhas de quadro branco, tenho usado da marca <a href=\"https://b2b.brwsuprimentos.com.br/produto/listar/giz-liquido-o\">BRW.</a></p>\n<p>A grande vantagem é que quando acaba o Giz Líquido eles continuam com o giz normal, que é baratinho :)<br><br>Espero que gostem das dicas!<br><br>[s]</p>\n<p> </p>\n<p> </p>",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "Casa"
            ],
            "date_published": "2021-11-05T14:04:25-03:00",
            "date_modified": "2021-11-06T06:28:30-03:00"
        },
        {
            "id": "https://gutocarvalho.net/criando-um-cluster-k8s-com-eksctl/",
            "url": "https://gutocarvalho.net/criando-um-cluster-k8s-com-eksctl/",
            "title": "DROPS: Criando um Cluster K8S com EKSCTL",
            "summary": "Aprende aí como fazer isso com uma mão nas costas! Criando um&hellip;",
            "content_html": "<p>Aprende aí como fazer isso com uma mão nas costas!</p>\n<hr>\n<p>Criando um cluster para testes de forma rápida e rasteira, vamo nessa!</p>\n<pre><code>$ eksctl create cluster \\\n    --region us-east-1 \\\n    --name falagutera \\\n    --version 1.21 \\\n    --node-type t3.xlarge \\\n    --nodes 3 \\\n    --ssh-public-key &quot;~/nativetrail.pub&quot;\n</code></pre>\n<p>gerando o kubeconfig</p>\n<pre><code>$ aws eks --region us-east-1 update-kubeconfig --name falagutera\n$ export KUBECONFIG=config\n</code></pre>\n<p>checando o cluster baby</p>\n<pre><code>$ kubectl get nodes\n</code></pre>\n<p>terminou o teste? bora derrubar tudo!</p>\n<pre><code>$ eksctl delete cluster falagutera\n</code></pre>\n<p>pronto!</p>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "K8S",
                   "Drops"
            ],
            "date_published": "2021-11-02T09:48:13-03:00",
            "date_modified": "2021-11-02T11:37:55-03:00"
        },
        {
            "id": "https://gutocarvalho.net/usando-efs-em-um-cluster-k8s-ec2/",
            "url": "https://gutocarvalho.net/usando-efs-em-um-cluster-k8s-ec2/",
            "title": "DROPS: Usando EFS em um Cluster K8S EC2",
            "summary": "Aprenda a usar o EFS Provisioner em um Cluster K8S EC2/RKE. São&hellip;",
            "content_html": "<p>Aprenda a usar o EFS Provisioner em um Cluster K8S EC2/RKE.</p>\n<hr>\n<h3 id=\"o-que-são-drops\">O que são drops?</h3>\n<p>São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam. </p>\n<p>Geralmente de algo que eu acabei de fazer.</p>\n<p>Eu – quase sempre – volto para detalhar mais cada passo.</p>\n<p>Considere com a mesma qualidade de um rascunho ou uma anotação rápida.</p>\n<p>De qualquer forma comenta ai qquer coisa, os comentários estão ligados nos DROPS ;)</p>\n<h3 id=\"veio-a-demanda\">Veio a Demanda!</h3>\n<p>A ideia é instalar um EFS Provisioner no cluster para poder subir APPS que montam o mesmo volume em diferentes PODs.</p>\n<h3 id=\"então-comofaz\">Então ComoFaz?</h3>\n<p>Crie o arquivo instala_efs_provisioner.yaml</p>\n<pre><code>vim aplica.yaml\n</code></pre>\n<p>Insira o conteúdo abaixo</p>\n<pre><code>---\nkind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: efs-provisioner-runner\nrules:\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;persistentvolumes&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;delete&quot;]\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;persistentvolumeclaims&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;update&quot;]\n  - apiGroups: [&quot;storage.k8s.io&quot;]\n    resources: [&quot;storageclasses&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;]\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;events&quot;]\n    verbs: [&quot;create&quot;, &quot;update&quot;, &quot;patch&quot;]\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: run-efs-provisioner\nsubjects:\n  - kind: ServiceAccount\n    name: efs-provisioner\n    namespace: kube-system\nroleRef:\n  kind: ClusterRole\n  name: efs-provisioner-runner\n  apiGroup: rbac.authorization.k8s.io\n---\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: leader-locking-efs-provisioner\nrules:\n  - apiGroups: [&quot;&quot;]\n    resources: [&quot;endpoints&quot;]\n    verbs: [&quot;get&quot;, &quot;list&quot;, &quot;watch&quot;, &quot;create&quot;, &quot;update&quot;, &quot;patch&quot;]\n---\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: leader-locking-efs-provisioner\nsubjects:\n  - kind: ServiceAccount\n    name: efs-provisioner\n    namespace: kube-system\nroleRef:\n  kind: Role\n  name: leader-locking-efs-provisioner\n  apiGroup: rbac.authorization.k8s.io\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: efs-provisioner\n---\nkind: Deployment\napiVersion: apps/v1\nmetadata:\n  name: efs-provisioner\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: efs-provisioner\n  strategy:\n    type: Recreate\n  template:\n    metadata:\n      labels:\n        app: efs-provisioner\n    spec:\n      serviceAccount: efs-provisioner\n      containers:\n        - name: efs-provisioner\n          image: quay.io/external_storage/efs-provisioner:latest\n          env:\n            - name: FILE_SYSTEM_ID\n              valueFrom:\n                configMapKeyRef:\n                  name: efs-provisioner\n                  key: file.system.id\n            - name: AWS_REGION\n              valueFrom:\n                configMapKeyRef:\n                  name: efs-provisioner\n                  key: aws.region\n            - name: DNS_NAME\n              valueFrom:\n                configMapKeyRef:\n                  name: efs-provisioner\n                  key: dns.name\n                  optional: true\n            - name: PROVISIONER_NAME\n              valueFrom:\n                configMapKeyRef:\n                  name: efs-provisioner\n                  key: provisioner.name\n          volumeMounts:\n            - name: pv-volume\n              mountPath: /persistentvolumes\n      volumes:\n        - name: pv-volume\n          nfs:\n            server: fs-&lt;ID DO SEU EFS&gt;.efs.&lt;REGIAO AWS&gt;.amazonaws.com\n            path: /\n---\nkind: StorageClass\napiVersion: storage.k8s.io/v1\nmetadata:\n  name: aws-efs\nprovisioner: nativetrail.io/aws-efs\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: efs-provisioner\ndata:\n  file.system.id: fs-&lt;ID DO SEU EFS&gt;\n  aws.region: &lt;REGIAO AWS&gt;\n  provisioner.name: nativetrail.io/aws-efs\n  dns.name: &quot;&quot;\n</code></pre>\n<p>Ajuste o ID do seu EFS e região da AWS no manifesto acima, e prestenção, tem que o usar o namespace <strong>kube-system</strong> pois ele é especificado nas <strong>roles</strong> e <strong>serviceaccount</strong>, se instalar o deployment em outro namespace não vai funcionar.</p>\n<pre><code>kubectl apply -f instala_efs_provisioner.yaml -n kube-system\n    \n</code></pre>\n<p>Pronto, vamos verificar</p>\n<pre><code>kubectl get sc\n</code></pre>\n<p>Saída esperada</p>\n<pre><code>NAME                PROVISIONER              RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\naws-efs             nativetrail.io/aws-efs   Delete          Immediate           false                  43m\naws-ebs (default)   ebs.csi.aws.com          Delete          Immediate           false                  3d16h\n</code></pre>\n<p>agora vamos testar, crie o manifesto valida-pod-efs.ym com o conteúdo abaixo</p>\n<pre><code>---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: valida-aws-efs\nspec:\n  accessModes:\n    - ReadWriteMany\n  storageClassName: aws-efs\n  resources:\n    requests:\n      storage: 1Gi\n</code></pre>\n<p>aplique</p>\n<pre><code>kubectl apply -f pod-efs.yaml\n</code></pre>\n<p>saída</p>\n<pre><code>persistentvolumeclaim/valida-aws-efs created\n</code></pre>\n<p>vamos ver</p>\n<pre><code>kubectl get pvc valida-aws-efs\n</code></pre>\n<p>saída</p>\n<pre><code>NAME             STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE\nvalida-aws-efs   Bound    pvc-c524234f-4b07-4248-b328-c6c164dddbc2   1Gi        RWX            aws-efs        3m42s\n</code></pre>\n<p>agora com mais detalhes</p>\n<pre><code>kubectl describe pvc valida-aws-efs\n</code></pre>\n<p>saída</p>\n<pre><code>Name:          valida-aws-efs\nNamespace:     default\nStorageClass:  aws-efs\nStatus:        Bound\nVolume:        pvc-c524234f-4b07-4248-b328-c6c164dddbc2\nLabels:        &lt;none&gt;\nAnnotations:   pv.kubernetes.io/bind-completed: yes\n               pv.kubernetes.io/bound-by-controller: yes\n               volume.beta.kubernetes.io/storage-provisioner: nativetrail.io/aws-efs\nFinalizers:    [kubernetes.io/pvc-protection]\nCapacity:      1Gi\nAccess Modes:  RWX\nVolumeMode:    Filesystem\nUsed By:       &lt;none&gt;\nEvents:\n  Type    Reason                 Age                    From                                                                                   Message\n  ----    ------                 ----                   ----                                                                                   -------\n  Normal  Provisioning           3m49s                  nativetrail.io/aws-efs_efs-provisioner-644f9f8c8c-n6n48_be97e87c-7e5b-4b42-8756-2adb23a5a105  External provisioner is provisioning volume for claim &quot;default/valida-aws-efs&quot;\n  Normal  ProvisioningSucceeded  3m49s                  nativetrail.io/aws-efs_efs-provisioner-644f9f8c8c-n6n48_be97e87c-7e5b-4b42-8756-2adb23a5a105  Successfully provisioned volume pvc-c524234f-4b07-4248-b328-c6c164dddbc2\n</code></pre>\n<p>Perfeito, tudo funcionando, agora é só usar!</p>\n<p>:)</p>\n<h3 id=\"refs\">refs</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rke\">https://github.com/rancher/rke</a></li>\n<li><a href=\"https://kubernetes.io/pt-br/\">https://kubernetes.io/pt-br/</a></li>\n<li><a href=\"https://aws.amazon.com/efs/\">https://aws.amazon.com/efs/</a></li>\n<li><a href=\"https://github.com/kubernetes-retired/external-storage/tree/master/aws/efs\">https://github.com/kubernetes-retired/external-storage/tree/master/aws/efs</a></li>\n<li><a href=\"https://icicimov.github.io/blog/virtualization/Kubernetes-NFS-shared-storage-in-AWS-with-EFS/\">https://icicimov.github.io/blog/virtualization/Kubernetes-NFS-shared-storage-in-AWS-with-EFS/</a></li>\n</ul>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "K8S",
                   "Drops"
            ],
            "date_published": "2021-10-24T11:06:27-03:00",
            "date_modified": "2021-10-25T08:03:34-03:00"
        },
        {
            "id": "https://gutocarvalho.net/centralizando-logs-do-k8s-com-o-loki/",
            "url": "https://gutocarvalho.net/centralizando-logs-do-k8s-com-o-loki/",
            "title": "DROPS: Centralizando Logs do K8S com o Loki",
            "summary": "Aprenda a instalar o LOKI da GrafanaLabs para centralizar Logs do K8S.",
            "content_html": "<p>Aprenda a instalar o LOKI da GrafanaLabs para centralizar Logs do K8S.</p>\n<hr>\n<h3 id=\"o-que-são-drops\">O que são drops?</h3>\n<p>São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam. </p>\n<p>Geralmente de algo que eu acabei de fazer.</p>\n<p>Eu – quase sempre – volto para detalhar mais cada passo.</p>\n<p>Considere com a mesma qualidade de um rascunho ou uma anotação rápida.</p>\n<p>De qualquer forma comenta ai qquer coisa, os comentários estão ligados nos DROPS ;)</p>\n<h3 id=\"demanda\">Demanda!</h3>\n<p>A ideia é instalar um Loki no cluster K8S e começar a centralizar e consumir os logs via dashboard do grafana.</p>\n<h3 id=\"por-que-o-loki\">Por que o Loki?</h3>\n<p>O Loki é leve – em resumo esse é o maior e melhor motivo para usar ele.</p>\n<p>Comparando com outras STACKS, ele nao leva 1/3 ou 2/3 do seu cluster só para centralizar logs.</p>\n<p>Você acompanha os logs pelo Grafana Dashboard, simples e direto.</p>\n<p>Além disso o projeto tem 14 mil estrelas no GitHub e mais de 400 contribuidores :)</p>\n<p>Conheça mais do projeto, dá um chance vai :)</p>\n<ul>\n<li><a href=\"https://grafana.com/docs/loki/latest/overview/\">https://grafana.com/docs/loki/latest/overview/</a></li>\n<li><a href=\"https://grafana.com/docs/loki/latest/overview/comparisons/\">https://grafana.com/docs/loki/latest/overview/comparisons/</a></li>\n</ul>\n<h3 id=\"antes-de-começar\">Antes de começar</h3>\n<p>Estou partindo do pressuposto de que você não tem o grafana instalado!</p>\n<p>Precisa ter o Helm instalado e um cluster k8s funcional.</p>\n<h3 id=\"então-comofaz\">Então ComoFaz?</h3>\n<p>adicione o repositorio e atualize os índices</p>\n<pre><code>helm repo add grafana https://grafana.github.io/helm-charts\nhelm repo update\n</code></pre>\n<p>instale o loki</p>\n<pre><code>helm upgrade --install loki --namespace=loki grafana/loki alertmanager.persistentVolume.enabled=true\n</code></pre>\n<p>instale o grafana</p>\n<pre><code>helm install loki-grafana grafana/grafana\n</code></pre>\n<p>pegue a senha de admin do grafana</p>\n<pre><code>kubectl get secret --namespace &lt;YOUR-NAMESPACE&gt; loki-grafana -o jsonpath=&quot;{.data.admin-password}&quot; | base64 --decode ; echo\n</code></pre>\n<p>crie um port-forward para acessar o grafana</p>\n<pre><code>kubectl port-forward --namespace &lt;YOUR-NAMESPACE&gt; service/loki-grafana 3000:80\n</code></pre>\n<p>acesse o grafana</p>\n<pre><code>http://localhost:3000\n</code></pre>\n<p>adicione o datasource conforme a doc abaixo</p>\n<ul>\n<li><a href=\"https://grafana.com/docs/loki/latest/getting-started/grafana/\">https://grafana.com/docs/loki/latest/getting-started/grafana/</a></li>\n</ul>\n<p>Pronto, divirta-se!</p>\n<h3 id=\"refs\">Refs</h3>\n<ul>\n<li><a href=\"https://grafana.com/docs/loki/latest/installation/helm/\">https://grafana.com/docs/loki/latest/installation/helm/</a></li>\n<li><a href=\"https://grafana.com/go/webinar/loki-getting-started-emea\">https://grafana.com/go/webinar/loki-getting-started-emea</a></li>\n<li><a href=\"https://grafana.com/blog/2020/10/28/loki-2.0-released-transform-logs-as-youre-querying-them-and-set-up-alerts-within-loki\">https://grafana.com/blog/2020/10/28/loki-2.0-released-transform-logs-as-youre-querying-them-and-set-up-alerts-within-loki</a></li>\n</ul>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "Projetos",
                   "Drops"
            ],
            "date_published": "2021-10-22T09:43:24-03:00",
            "date_modified": "2021-10-22T09:47:50-03:00"
        },
        {
            "id": "https://gutocarvalho.net/drops-instalando-rancher-26-em-ha/",
            "url": "https://gutocarvalho.net/drops-instalando-rancher-26-em-ha/",
            "title": "DROPS: Instalando Rancher 2.6 em HA",
            "summary": "Aprenda a instalar o novíssimo Rancher 2.6 em modo HA. São DUMPs&hellip;",
            "content_html": "<p>Aprenda a instalar o novíssimo Rancher 2.6 em modo HA.</p>\n<hr>\n<h3 id=\"o-que-são-drops\">O que são drops?</h3>\n<p>São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam. </p>\n<p>Geralmente de algo que eu acabei de fazer.</p>\n<p>Eu – quase sempre – volto para detalhar mais cada passo.</p>\n<p>Considere com a mesma qualidade de um rascunho ou uma anotação rápida.</p>\n<p>De qualquer forma comenta ai qquer coisa, os comentários estão ligados nos DROPS ;)</p>\n<h2 id=\"demanda\">Demanda!</h2>\n<p>A ideia é instalar um Rancher em HA, cluster de 3 nodes, usando instâncias AWS EC2.</p>\n<h2 id=\"comofaz\">ComoFaz?</h2>\n<h3 id=\"antes-de-começar\">antes de começar</h3>\n<p>Confere aí :)</p>\n<ol>\n<li>Tenha o Kubectl instalado</li>\n<li>Tenha o RKE instalado</li>\n<li>Tenha o Helm instalado</li>\n<li>Tenha Conta na AWS</li>\n<li>Internet é de bom tom :)</li>\n</ol>\n<h3 id=\"instâncias-ec2\">instâncias ec2</h3>\n<p>Vamos lá!</p>\n<ol>\n<li>crie um chave ssh no ec2</li>\n<li>crie 3 instâncias EC2 em sua conta AWS com essa chave ssh</li>\n<li>crie 2 target groups rancher-80 e rancher-443 apontando para as máquinas do cluster</li>\n<li>crie o load balancer NLB com dois listeners apontando para os target groups rancher-80 e rancher-443</li>\n<li>crie uma entrada de dns <strong>rancher.seudominio.tld</strong> apontando para o CNAME do Load Balancer</li>\n<li>crie um security group para liberar acesso a porta 80 e 443 as máquinas do cluster</li>\n<li>crie um security group para que voce possa instalar o cluster a partir do seu IP via rke (all ports).</li>\n</ol>\n<h3 id=\"preparando-instâncias\">preparando instâncias</h3>\n<p>instale docker nas 3 maquinas</p>\n<pre><code>curl https://releases.rancher.com/install-docker/20.10.sh | sh\n</code></pre>\n<p>habilite e inicie</p>\n<pre><code>systemctl enable docker &amp;&amp; systemctl start docker\n</code></pre>\n<p>coloque o ubuntu no grupo docker</p>\n<pre><code>gpasswd -a ubuntu docker\n</code></pre>\n<h3 id=\"preparando-e-instalando-o-cluster-da-sua-máquina\">preparando e instalando o cluster (da sua máquina)</h3>\n<p>criando configuracao</p>\n<pre><code>rke config\n</code></pre>\n<p>ele vai te fazer umas perguntinhas, cadastre apenas 1 node para facilitar, eu usei 1.1.1.1 como exemplo, aponte o local da sua chave ssh, a mesma que usou nos EC2.</p>\n<pre><code>[+] Cluster Level SSH Private Key Path [~/.ssh/id_rsa]:\n[+] Number of Hosts [1]:\n[+] SSH Address of host (1) [none]: 1.1.1.1\n[+] SSH Port of host (1) [22]:\n[+] SSH Private Key Path of host (1.1.1.1) [none]:\n[-] You have entered empty SSH key path, trying fetch from SSH key parameter\n[+] SSH Private Key of host (1.1.1.1) [none]:\n[-] You have entered empty SSH key, defaulting to cluster level SSH key: ~/.ssh/id_rsa\n[+] SSH User of host (1.1.1.1) [ubuntu]:\n[+] Is host (1.1.1.1) a Control Plane host (y/n)? [y]: y\n[+] Is host (1.1.1.1) a Worker host (y/n)? [n]: y\n[+] Is host (1.1.1.1) an etcd host (y/n)? [n]: y\n[+] Override Hostname of host (1.1.1.1) [none]:\n[+] Internal IP of host (1.1.1.1) [none]:\n[+] Docker socket path on host (1.1.1.1) [/var/run/docker.sock]:\n[+] Network Plugin Type (flannel, calico, weave, canal, aci) [canal]:\n[+] Authentication Strategy [x509]:\n[+] Authorization Mode (rbac, none) [rbac]:\n[+] Kubernetes Docker image [rancher/hyperkube:v1.21.5-rancher1]:\n[+] Cluster domain [cluster.local]:\n[+] Service Cluster IP Range [10.43.0.0/16]:\n[+] Enable PodSecurityPolicy [n]:\n[+] Cluster Network CIDR [10.42.0.0/16]:\n[+] Cluster DNS Service IP [10.43.0.10]:\n[+] Add addon manifest URLs or YAML files [no]:\n</code></pre>\n<p>abra o arquivo e coloque os demais nodos, não se esqueça de cadastrar o ip privado também, depois que finalizar com os nodos, personalize o que for necessário para seu ambiente k8s, o rke é beeem flexível quanto a isso, além de ser o instalador de k8s mais fácil que eu conheço.</p>\n<pre><code>nodes:\n- address: 1.1.1.1\n  port: &quot;22&quot;\n  internal_address: &quot;172.31.1.1&quot;\n  role:\n  - controlplane\n  - worker\n  - etcd\n  hostname_override: &quot;rancher_a&quot;\n  user: ubuntu\n  docker_socket: /var/run/docker.sock\n  ssh_key: &quot;&quot;\n  ssh_key_path: ~/.ssh/id_rsa\n  ssh_cert: &quot;&quot;\n  ssh_cert_path: &quot;&quot;\n  labels: {}\n  taints: []\n- address: 2.2.2.2\n  port: &quot;22&quot;\n  internal_address: &quot;172.31.1.2&quot;\n  role:\n  - controlplane\n  - worker\n  - etcd\n  hostname_override: &quot;rancher_b&quot;\n  user: ubuntu\n  docker_socket: /var/run/docker.sock\n  ssh_key: &quot;&quot;\n  ssh_key_path: ~/.ssh/id_rsa\n  ssh_cert: &quot;&quot;\n  ssh_cert_path: &quot;&quot;\n  labels: {}\n  taints: []\n- address: 3.3.3.3\n  port: &quot;22&quot;\n  internal_address: &quot;172.31.1.3&quot;\n  role:\n  - controlplane\n  - worker\n  - etcd\n  hostname_override: &quot;rancher_c&quot;\n  user: ubuntu\n  docker_socket: /var/run/docker.sock\n  ssh_key: &quot;&quot;\n  ssh_key_path: ~/.ssh/id_rsa\n  ssh_cert: &quot;&quot;\n  ssh_cert_path: &quot;&quot;\n  labels: {}\n  taints: []\nservices:\n  etcd:\n    image: &quot;&quot;\n    extra_args: {}\n    extra_binds: []\n    extra_env: []\n    win_extra_args: {}\n    win_extra_binds: []\n    win_extra_env: []\n    external_urls: []\n    ca_cert: &quot;&quot;\n    cert: &quot;&quot;\n    key: &quot;&quot;\n    path: &quot;&quot;\n    uid: 0\n    gid: 0\n    snapshot: null\n    retention: &quot;&quot;\n    creation: &quot;&quot;\n    backup_config: null\n  kube-api:\n    image: &quot;&quot;\n    extra_args: {}\n    extra_binds: []\n    extra_env: []\n    win_extra_args: {}\n    win_extra_binds: []\n    win_extra_env: []\n    service_cluster_ip_range: 10.43.0.0/16\n    service_node_port_range: &quot;&quot;\n    pod_security_policy: false\n    always_pull_images: false\n    secrets_encryption_config: null\n    audit_log: null\n    admission_configuration: null\n    event_rate_limit: null\n  kube-controller:\n    image: &quot;&quot;\n    extra_args: {}\n    extra_binds: []\n    extra_env: []\n    win_extra_args: {}\n    win_extra_binds: []\n    win_extra_env: []\n    cluster_cidr: 10.42.0.0/16\n    service_cluster_ip_range: 10.43.0.0/16\n  scheduler:\n    image: &quot;&quot;\n    extra_args: {}\n    extra_binds: []\n    extra_env: []\n    win_extra_args: {}\n    win_extra_binds: []\n    win_extra_env: []\n  kubelet:\n    image: &quot;&quot;\n    extra_args: {}\n    extra_binds: []\n    extra_env: []\n    win_extra_args: {}\n    win_extra_binds: []\n    win_extra_env: []\n    cluster_domain: cluster.local\n    infra_container_image: &quot;&quot;\n    cluster_dns_server: 10.43.0.10\n    fail_swap_on: false\n    generate_serving_certificate: false\n  kubeproxy:\n    image: &quot;&quot;\n    extra_args: {}\n    extra_binds: []\n    extra_env: []\n    win_extra_args: {}\n    win_extra_binds: []\n    win_extra_env: []\nnetwork:\n  plugin: canal\n  options: {}\n  mtu: 0\n  node_selector: {}\n  update_strategy: null\n  tolerations: []\nauthentication:\n  strategy: x509\n  sans: []\n  webhook: null\naddons: &quot;&quot;\naddons_include: []\nsystem_images:\n  etcd: rancher/mirrored-coreos-etcd:v3.4.16-rancher1\n  alpine: rancher/rke-tools:v0.1.78\n  nginx_proxy: rancher/rke-tools:v0.1.78\n  cert_downloader: rancher/rke-tools:v0.1.78\n  kubernetes_services_sidecar: rancher/rke-tools:v0.1.78\n  kubedns: rancher/mirrored-k8s-dns-kube-dns:1.17.4\n  dnsmasq: rancher/mirrored-k8s-dns-dnsmasq-nanny:1.17.4\n  kubedns_sidecar: rancher/mirrored-k8s-dns-sidecar:1.17.4\n  kubedns_autoscaler: rancher/mirrored-cluster-proportional-autoscaler:1.8.3\n  coredns: rancher/mirrored-coredns-coredns:1.8.4\n  coredns_autoscaler: rancher/mirrored-cluster-proportional-autoscaler:1.8.3\n  nodelocal: rancher/mirrored-k8s-dns-node-cache:1.18.0\n  kubernetes: rancher/hyperkube:v1.21.5-rancher1\n  flannel: rancher/mirrored-coreos-flannel:v0.14.0\n  flannel_cni: rancher/flannel-cni:v0.3.0-rancher6\n  calico_node: rancher/mirrored-calico-node:v3.19.2\n  calico_cni: rancher/mirrored-calico-cni:v3.19.2\n  calico_controllers: rancher/mirrored-calico-kube-controllers:v3.19.2\n  calico_ctl: rancher/mirrored-calico-ctl:v3.19.2\n  calico_flexvol: rancher/mirrored-calico-pod2daemon-flexvol:v3.19.2\n  canal_node: rancher/mirrored-calico-node:v3.19.2\n  canal_cni: rancher/mirrored-calico-cni:v3.19.2\n  canal_controllers: rancher/mirrored-calico-kube-controllers:v3.19.2\n  canal_flannel: rancher/mirrored-coreos-flannel:v0.14.0\n  canal_flexvol: rancher/mirrored-calico-pod2daemon-flexvol:v3.19.2\n  weave_node: weaveworks/weave-kube:2.8.1\n  weave_cni: weaveworks/weave-npc:2.8.1\n  pod_infra_container: rancher/mirrored-pause:3.4.1\n  ingress: rancher/nginx-ingress-controller:nginx-0.48.1-rancher1\n  ingress_backend: rancher/mirrored-nginx-ingress-controller-defaultbackend:1.5-rancher1\n  ingress_webhook: rancher/mirrored-jettech-kube-webhook-certgen:v1.5.1\n  metrics_server: rancher/mirrored-metrics-server:v0.5.0\n  windows_pod_infra_container: rancher/kubelet-pause:v0.1.6\n  aci_cni_deploy_container: noiro/cnideploy:5.1.1.0.1ae238a\n  aci_host_container: noiro/aci-containers-host:5.1.1.0.1ae238a\n  aci_opflex_container: noiro/opflex:5.1.1.0.1ae238a\n  aci_mcast_container: noiro/opflex:5.1.1.0.1ae238a\n  aci_ovs_container: noiro/openvswitch:5.1.1.0.1ae238a\n  aci_controller_container: noiro/aci-containers-controller:5.1.1.0.1ae238a\n  aci_gbp_server_container: noiro/gbp-server:5.1.1.0.1ae238a\n  aci_opflex_server_container: noiro/opflex-server:5.1.1.0.1ae238a\nssh_key_path: ~/.ssh/id_rsa\nssh_cert_path: &quot;&quot;\nssh_agent_auth: false\nauthorization:\n  mode: rbac\n  options: {}\nignore_docker_version: null\nenable_cri_dockerd: null\nkubernetes_version: &quot;&quot;\nprivate_registries: []\ningress:\n  provider: &quot;&quot;\n  options: {}\n  node_selector: {}\n  extra_args: {}\n  dns_policy: &quot;&quot;\n  extra_envs: []\n  extra_volumes: []\n  extra_volume_mounts: []\n  update_strategy: null\n  http_port: 0\n  https_port: 0\n  network_mode: &quot;&quot;\n  tolerations: []\n  default_backend: null\n  default_http_backend_priority_class_name: &quot;&quot;\n  nginx_ingress_controller_priority_class_name: &quot;&quot;\ncluster_name: &quot;&quot;\ncloud_provider:\n  name: &quot;&quot;\nprefix_path: &quot;&quot;\nwin_prefix_path: &quot;&quot;\naddon_job_timeout: 0\nbastion_host:\n  address: &quot;&quot;\n  port: &quot;&quot;\n  user: &quot;&quot;\n  ssh_key: &quot;&quot;\n  ssh_key_path: &quot;&quot;\n  ssh_cert: &quot;&quot;\n  ssh_cert_path: &quot;&quot;\n  ignore_proxy_env_vars: false\nmonitoring:\n  provider: &quot;&quot;\n  options: {}\n  node_selector: {}\n  update_strategy: null\n  replicas: null\n  tolerations: []\n  metrics_server_priority_class_name: &quot;&quot;\nrestore:\n  restore: false\n  snapshot_name: &quot;&quot;\nrotate_encryption_key: false\ndns: null\n</code></pre>\n<p>depois de cadastrar os nodos, vamos começar o provisionamento</p>\n<pre><code>rke up —config cluster.yaml\n</code></pre>\n<p>após instalar verá a seguinte mensagem ( se tudo der certo )</p>\n<pre><code>INFO[0255] Finished building Kubernetes cluster successfully\n</code></pre>\n<p>configure o kubectl</p>\n<pre><code>export KUBECONFIG=kube_config_cluster.yml\n</code></pre>\n<p>verifique se o cluster está funcionando</p>\n<pre><code>kubctl get nodes\n</code></pre>\n<p>saída exemplo</p>\n<pre><code>NAME             STATUS   ROLES                      AGE   VERSION\n54.225.184.xxx   Ready    controlplane,etcd,worker   12m   v1.21.5\n54.243.65.xxx    Ready    controlplane,etcd,worker   12m   v1.21.5\n72.44.32.xxx     Ready    controlplane,etcd,worker   12m   v1.21.5\n</code></pre>\n<p>cluster instalado, agora verifique a saúde de seu cluster</p>\n<pre><code>kubectl get pods --all-namespaces\n</code></pre>\n<p>saída exemplo</p>\n<pre><code>NAMESPACE       NAME                                       READY   STATUS      RESTARTS   AGE\ningress-nginx   default-http-backend-6977475d9b-z64cj      1/1     Running     0          17m\ningress-nginx   nginx-ingress-controller-h4c67             1/1     Running     0          17m\ningress-nginx   nginx-ingress-controller-kjd8r             1/1     Running     0          17m\ningress-nginx   nginx-ingress-controller-q4lp2             1/1     Running     0          17m\nkube-system     calico-kube-controllers-7d5d95c8c9-mcfj6   1/1     Running     0          18m\nkube-system     canal-lsbkv                                2/2     Running     0          18m\nkube-system     canal-lwtq9                                2/2     Running     0          18m\nkube-system     canal-wm7c8                                2/2     Running     0          18m\nkube-system     coredns-55b58f978-jnfsq                    1/1     Running     0          17m\nkube-system     coredns-55b58f978-wr4w7                    1/1     Running     0          18m\nkube-system     coredns-autoscaler-76f8869cc9-lz44p        1/1     Running     0          18m\nkube-system     metrics-server-55fdd84cd4-rjk7w            1/1     Running     0          18m\nkube-system     rke-coredns-addon-deploy-job-th472         0/1     Completed   0          18m\nkube-system     rke-ingress-controller-deploy-job-59cm4    0/1     Completed   0          17m\nkube-system     rke-metrics-addon-deploy-job-94b8t         0/1     Completed   0          18m\nkube-system     rke-network-plugin-deploy-job-q5nts        0/1     Completed   0          18m\n</code></pre>\n<p>aparentemente tudo bem :)</p>\n<h3 id=\"preparando-e-instalando-o-cert-manager-neste-cluster-sua-máquina\">preparando e instalando o cert-manager neste cluster (sua máquina)</h3>\n<p>instale os crds do cert-manager</p>\n<pre><code>kubectl apply -f https://github.com/jetstack/cert-manager/releases/download/v1.5.1/cert-manager.crds.yaml\n</code></pre>\n<p>adicione o repo e atualize o índices</p>\n<pre><code>helm repo add jetstack https://charts.jetstack.io. \nhelm repo update\n</code></pre>\n<p>crie o namespace</p>\n<pre><code>kubectl create namespace cert-manager\n</code></pre>\n<p>instale o cert-mamanger</p>\n<pre><code>helm install cert-manager jetstack/cert-manager \\\n  --namespace cert-manager \\\n  --create-namespace \\\n  --version v1.5.1\n</code></pre>\n<p>crie o cluster issuer, sem isso ele não gera os certs via lets</p>\n<pre><code>apiVersion: cert-manager.io/v1\nkind: ClusterIssuer\nmetadata:\n  name: letsencrypt-prod\n  namespace: cert-manager\nspec:\n  acme:\n    # The ACME server URL\n    server: https://acme-v02.api.letsencrypt.org/directory\n    # Email address used for ACME registration\n    email: certmanager@nativetrail.io\n    # Name of a secret used to store the ACME account private key\n    privateKeySecretRef:\n      name: letsencrypt-prod\n    # Enable the HTTP-01 challenge provider\n    solvers:\n    - http01:\n        ingress:\n          class: nginx\n</code></pre>\n<p>aplique o issuer</p>\n<pre><code>kubectl apply -f issuer.yml\n</code></pre>\n<p>saída esperada</p>\n<pre><code> clusterissuer.cert-manager.io/letsencrypt-prod created\n</code></pre>\n<p>verifique se está ok</p>\n<pre><code>kubectl get clusterissuer \n</code></pre>\n<p>saída esperada</p>\n<pre><code>NAME               READY   AGE\nletsencrypt-prod   True    48s\n</code></pre>\n<p>se estiver mostrando “True” deu certo!</p>\n<h3 id=\"preparando-e-instalando-o-rancher-neste-cluster-na-sua-máquina\">preparando e instalando o rancher neste cluster (na sua máquina)</h3>\n<p>adicione o repo e atualize os índices</p>\n<pre><code>helm repo add rancher-latest https://releases.rancher.com/server-charts/latest\nhelm repo update\n</code></pre>\n<p>crie o namespace cattle-system</p>\n<pre><code>kubectl create namespace cattle-system\n</code></pre>\n<p>instale o rancher</p>\n<pre><code>helm install rancher rancher-latest/rancher \\\n  --namespace cattle-system \\\n  --set hostname=kloud.gr1d.io \\\n  --set replicas=3 \\\n  --set ingress.tls.source=letsEncrypt \\\n  --set letsEncrypt.email=certmanager@nativetrail.io\n</code></pre>\n<p>verifique</p>\n<pre><code>kubectl get pods -n cattle-system\n</code></pre>\n<p>saída esperada, estará criando na primeira vez que rodar o comando</p>\n<pre><code>NAME                       READY   STATUS              RESTARTS   AGE\nrancher-58b56d54df-7mv7d   0/1     ContainerCreating   0          29s\nrancher-58b56d54df-csmpl   0/1     ContainerCreating   0          29s\nrancher-58b56d54df-pkpz6   0/1     ContainerCreating   0          29s\n</code></pre>\n<p>aguarde e verifique novamente, use o mesmo comando</p>\n<pre><code>kubectl get pods -n cattle-system\n</code></pre>\n<p>saída</p>\n<pre><code>NAME                       READY   STATUS    RESTARTS   AGE\nrancher-58b56d54df-7mv7d   0/1     Running   0          41s\nrancher-58b56d54df-csmpl   0/1     Running   0          41s\nrancher-58b56d54df-pkpz6   0/1     Running   0          41s\n</code></pre>\n<p>rancher instalado e rodando!</p>\n<h3 id=\"pós-instalação\">pós instalação</h3>\n<p>observe a saída do comando helm, ele vai te dizer como pegar a senha gerada para o primeiro acesso, depois disso, acesse o rancher via web através da URL definida e siga as os procedimentos para trocar a senha e iniciar o uso do seu rancher.</p>\n<h3 id=\"refs\">refs</h3>\n<ul>\n<li><a href=\"https://rancher.com/docs/rancher/v2.6/en/installation/install-rancher-on-k8s/\">https://rancher.com/docs/rancher/v2.6/en/installation/install-rancher-on-k8s/</a></li>\n<li><a href=\"https://rancher.com/docs/rancher/v2.6/en/installation/resources/k8s-tutorials/infrastructure-tutorials/infra-for-ha/\">https://rancher.com/docs/rancher/v2.6/en/installation/resources/k8s-tutorials/infrastructure-tutorials/infra-for-ha/</a></li>\n</ul>\n<p>:)</p>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "Projetos",
                   "Drops"
            ],
            "date_published": "2021-10-22T09:09:24-03:00",
            "date_modified": "2021-10-22T09:14:26-03:00"
        },
        {
            "id": "https://gutocarvalho.net/ferramentas-open-source-apm/",
            "url": "https://gutocarvalho.net/ferramentas-open-source-apm/",
            "title": "Ferramentas APM open source Self-Hosted",
            "summary": "Conheça algumas ferramentas open source para APM para seus projetos Estude e&hellip;",
            "content_html": "<p>Conheça algumas ferramentas open source para APM para seus projetos</p>\n<hr>\n<p>Estude e avalie essas boas ferramentas que você pode usar em seu projeto e infraestrutura.</p>\n<h2 id=\"apache-skywalking\">Apache Skywalking</h2>\n<p>Site do projeto: <a href=\"https://skywalking.apache.org/\">https://skywalking.apache.org/</a></p>\n<p>GitHub do projeto: 14.7k stars e 250+ contributors</p>\n<p>Recomendado para APPs rodando em Cloud e API.</p>\n<p>Se você está imerso no universo de API, microserviços, kubernetes e cloud native esse é o projeto para você, ele foi desenhado para Cloud e API sendo hoje um dos maiores, mais respeitados e ativos do GitHub.</p>\n<p>Há quem diga que é o melhor nesse segmento hoje.</p>\n<h2 id=\"pinpoint\">PinPoint</h2>\n<p>Site do projeto: <a href=\"https://github.com/naver/pinpoint\">https://github.com/naver/pinpoint</a></p>\n<p>GitHub 10.8k stars e 90+ contributors</p>\n<p>Acho que o PinPoint é o preferido da galera de JAVA em 2021, é bem conhecido e vastamente utilizado.</p>\n<p>Recomendado para APPs JAVA ou Python</p>\n<p>Baseado no Google’s Dapper.</p>\n<h2 id=\"stagemonitor\">StageMonitor</h2>\n<p>Site do projeto <a href=\"https://www.stagemonitor.org\">https://www.stagemonitor.org</a></p>\n<p>GitHub 1.6k stars e 24+ contributors</p>\n<p>Recomendado para JAVA, tem compatibilidade e integração com OpenTracing.</p>\n<h2 id=\"scouter\">Scouter</h2>\n<p>Site do projeto <a href=\"https://github.com/scouter-project/scouter\">https://github.com/scouter-project/scouter</a></p>\n<p>GitHub 1.8k starts e 40+ contributors.</p>\n<p>Inspirado no New Relic e APP Dynamics, é uma aplicação modular e bastante extensível.</p>\n<p>Oferece interações nativas com Telegraf e Zipkin.</p>\n<p>Tem agente nativo para java, linux, unix e até windows.</p>\n<p>Monitora nativamente (usando telegraph)</p>\n<ul>\n<li>Redis</li>\n<li>Nginx</li>\n<li>Apache HTTPd</li>\n<li>HAProxy</li>\n<li>Kafka</li>\n<li>MySQL</li>\n<li>MongoDB</li>\n<li>RabbitMQ</li>\n<li>ElasticSearch</li>\n<li>Kubernetes</li>\n<li>Mesos</li>\n</ul>\n<p>Instrumenta nativamente:</p>\n<ul>\n<li>C#</li>\n<li>GO</li>\n<li>Java</li>\n<li>JavaScript</li>\n<li>Ruby</li>\n<li>Scala</li>\n<li>PHP</li>\n</ul>\n<p>Instrumentação extendida via código da comunidade</p>\n<ul>\n<li>C++</li>\n<li>Python</li>\n<li>Clojure</li>\n<li>Elixir</li>\n<li>Lua</li>\n</ul>\n<p>Veja dados completos da instrumentação</p>\n<ul>\n<li><a href=\"https://zipkin.io/pages/tracers_instrumentation.html\">https://zipkin.io/pages/tracers_instrumentation.html</a> </li>\n</ul>\n<h2 id=\"app-metrics\">APP Metrics</h2>\n<p>Site do projeto <a href=\"https://www.app-metrics.io/\">https://www.app-metrics.io/</a></p>\n<p>GitHub 2k starts e 40+ contributors</p>\n<p>Recomendado para APPs .Net.</p>\n<p>Se o seu negócio é .NET o APP Metrics é a ferramenta pra você e seu time.</p>\n<h2 id=\"inspectit-ocelot\">InspectIT Ocelot</h2>\n<p>Site do projeto: <a href=\"https://github.com/inspectIT/inspectit-ocelot\">https://github.com/inspectIT/inspectit-ocelot</a></p>\n<p>GitHub 158 starts e 25+ contributors</p>\n<p>Esse é um projeto novo, o caçula da turma, mas tem muito potencial.</p>\n<p>Ele tem uma pegada na fácil configuração, aliás zero configuração e uma boa oferta nativa de métricas.</p>\n<p>E isso, bons estudos!</p>\n<p>[s]</p>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "Projetos"
            ],
            "date_published": "2021-10-17T16:29:13-03:00",
            "date_modified": "2021-10-17T16:34:29-03:00"
        },
        {
            "id": "https://gutocarvalho.net/k8s-port-forward-facil/",
            "url": "https://gutocarvalho.net/k8s-port-forward-facil/",
            "title": "DROPS: Fazer Port Forward no K8S é fácil :)",
            "summary": "Aprenda a se conectar em um serviço K8S sem exposição! São DUMPs&hellip;",
            "content_html": "<p>Aprenda a se conectar em um serviço K8S sem exposição!</p>\n<hr>\n<h3 id=\"o-que-são-drops\">O que são drops?</h3>\n<p>São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam. </p>\n<p>Geralmente de algo que eu acabei de fazer.</p>\n<p>Eu – quase sempre – volto para detalhar mais cada passo.</p>\n<p>Considere com a mesma qualidade de um rascunho ou uma anotação rápida.</p>\n<p>De qualquer forma comenta ai qquer coisa, os comentários estão ligados nos DROPS ;)</p>\n<h3 id=\"demanda\">Demanda!</h3>\n<p>Preciso me conectar em um Mongo no cluster sem expor ele para o mundo.</p>\n<h3 id=\"comofaz\">ComoFaz?</h3>\n<p>Vamos usar o port-forward, veja como a sintaxe é simples</p>\n<pre><code>kubectl port-forward nome_do_pod porta_local:portal_cluster -n seu_namespace\n</code></pre>\n<p>Exemplo!</p>\n<pre><code>kubectl port-forward mongodb-replicaset-0 28015:27017 -n seu_namespace\n</code></pre>\n<p>E como eu acho a porta certa</p>\n<pre><code>kubectl get pod mongodb-replicaset-0 --template=&#39;{{(index (index .spec.containers 0).ports 0).containerPort}}{{&quot;\\n&quot;}}&#39; -n seu_namespace\n</code></pre>\n<p>Prontinho!</p>\n<h3 id=\"refs\">Refs</h3>\n<ul>\n<li><a href=\"https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/\">https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/</a></li>\n</ul>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "K8S",
                   "Drops"
            ],
            "date_published": "2021-10-15T05:43:22-03:00",
            "date_modified": "2021-11-04T09:51:39-03:00"
        },
        {
            "id": "https://gutocarvalho.net/baixando-imagens-de-ecr-privado-no-k8s/",
            "url": "https://gutocarvalho.net/baixando-imagens-de-ecr-privado-no-k8s/",
            "title": "DROPS: Baixando imagens de ECR Privado no K8S",
            "summary": "Aprenda a pegar imagens de registry ECR privado em seu cluster K8S.",
            "content_html": "<p>Aprenda a pegar imagens de registry ECR privado em seu cluster K8S.</p>\n<hr>\n<h3 id=\"o-que-são-drops\">O que são drops?</h3>\n<p>São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam. </p>\n<p>Geralmente de algo que eu acabei de fazer.</p>\n<p>Eu – quase sempre – volto para detalhar mais cada passo.</p>\n<p>Considere com a mesma qualidade de um rascunho ou uma anotação rápida.</p>\n<p>De qualquer forma comenta ai qquer coisa, os comentários estão ligados nos DROPS ;)</p>\n<h3 id=\"demanda\">Demanda!</h3>\n<p>Precisamos cadastrar um secret para pegar imagens de um ECR privado</p>\n<h3 id=\"comofaz\">ComoFaz?</h3>\n<p>Primeiro vamos gerar o TOKEN, você precisa do AWS CLI para isso,</p>\n<pre><code>aws configure\n</code></pre>\n<p>depois de configurado gere o TOKEN</p>\n<pre><code>aws ecr get-login-password --region us-east-1\n</code></pre>\n<p>agora vamos no K8S criar o secret</p>\n<pre><code>kubectl create secret docker-registry ecr-nativetrail \\\n  --docker-server=ID.dkr.ecr.us-east-1.amazonaws.com/ \\\n  --docker-username=AWS \\\n  --docker-password=SEU_TOKEN_GERADO_VIA_AWS_CLI \\\n  --namespace=SEU_NAMESPACE\n</code></pre>\n<p>verifique</p>\n<pre><code>kubectl get secrets -n SEU_NAMESPACE|grep ecr\n</code></pre>\n<p>saída</p>\n<pre><code>ecr-nativetrail kubernetes.io/dockerconfigjson        1      15h\n</code></pre>\n<p>Nao se esqueça de setar o secret no seu manifesto de deployment, dentro de “spec” </p>\n<pre><code>      spec:\n        imagePullSecrets:\n        - name: ecr-nativetrail\n</code></pre>\n<p>Exemplo</p>\n<pre><code>  apiVersion: apps/v1\n  kind: Deployment\n  metadata:\n    name: app-example\n  spec:\n    replicas: 1\n    selector:\n      matchLabels:\n        app: app-example\n    template:\n      metadata:\n        labels:\n          app: nativetrail\n      spec:\n        imagePullSecrets:\n        - name: ecr-nativetrail\n        containers:\n        - name: app-examp;e\n          image:  ID.dkr.ecr.us-east-1.amazonaws.com/app:latest\n</code></pre>\n<p>Prontinho!</p>\n",
            "author": {
                "name": "Guto Carvalho"
            },
            "tags": [
                   "K8S",
                   "Drops"
            ],
            "date_published": "2021-10-14T12:39:31-03:00",
            "date_modified": "2021-10-15T05:55:59-03:00"
        }
    ]
}
