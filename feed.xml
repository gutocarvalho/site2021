<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>Guto@Site</title>
    <link href="https://gutocarvalho.net/feed.xml" rel="self" />
    <link href="https://gutocarvalho.net" />
    <updated>2022-01-06T15:09:05-03:00</updated>
    <author>
        <name>Guto Carvalho</name>
    </author>
    <id>https://gutocarvalho.net</id>

    <entry>
        <title>Ferramentas interessantes para k8s</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/ferramentas-interessantes-para-k8s/"/>
        <id>https://gutocarvalho.net/ferramentas-interessantes-para-k8s/</id>
            <category term="MindNotes"/>

        <updated>2022-01-06T15:09:05-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Conheça algumas ferramentas interessantes para seu k8s toolkit</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Conheça algumas ferramentas interessantes para seu k8s toolkit</p>

<p>Ferramentas interessantes para k8s</p>
<h2 id="toc_0">shell</h2>
<ul>
<li>https://github.com/cloudnativelabs/kube-shell'</li>
<li>https://github.com/jonmosco/kube-ps1</li>
</ul>
<h2 id="toc_1">port forwarding</h2>
<ul>
<li>https://github.com/txn2/kubefwd</li>
<li>https://www.electronjs.org/apps/kube-forwarder</li>
</ul>
<h2 id="toc_2">namespace and cluster switch (cli)</h2>
<ul>
<li>https://github.com/ahmetb/kubectx</li>
<li>https://github.com/sbstp/kubie</li>
<li>https://github.com/bitnami-labs/kubectl-import</li>
</ul>
<h2 id="toc_3">resources view (web)</h2>
<ul>
<li>https://github.com/FairwindsOps/goldilocks</li>
<li>https://github.com/stevelacy/kuberhaus</li>
</ul>
<h2 id="toc_4">backup</h2>
<ul>
<li>https://github.com/bpineau/katafygio</li>
<li>https://velero.io</li>
</ul>
<h2 id="toc_5">logs (cli)</h2>
<ul>
<li>https://github.com/johanhaleby/kubetail</li>
<li>https://github.com/boz/kail</li>
<li>https://github.com/wercker/stern</li>
</ul>
<h2 id="toc_6">monitoring (cli)</h2>
<ul>
<li>https://github.com/astefanutti/kubebox</li>
<li>https://github.com/hjacobs/kube-ops-view</li>
</ul>
<h2 id="toc_7">monitoring</h2>
<ul>
<li>https://www.weave.works/oss/scope</li>
<li>https://prometheus.io
<ul>
<li>https://github.com/cortexproject</li>
<li>https://github.com/thanos-io/thanos</li>
</ul>
</li>
<li>https://grafana.com/oss/grafana</li>
</ul>
<h2 id="toc_8">monitoring stack</h2>
<ul>
<li>https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack</li>
</ul>
<h2 id="toc_9">log system</h2>
<ul>
<li>https://github.com/grafana/loki</li>
<li>https://github.com/fluent/fluentd</li>
</ul>
<h2 id="toc_10">cli dashboard</h2>
<ul>
<li>https://github.com/derailed/k9s</li>
</ul>
<h2 id="toc_11">secrets</h2>
<ul>
<li>https://github.com/bitnami-labs/sealed-secrets</li>
<li>https://github.com/Shopify/ejson</li>
<li>https://github.com/mfuentesg/ksd</li>
</ul>
<h2 id="toc_12">mobile dashboard</h2>
<ul>
<li>https://github.com/bitnami-labs/cabin</li>
</ul>
<h2 id="toc_13">chaos test</h2>
<ul>
<li>https://github.com/asobti/kube-monkey</li>
<li>https://github.com/linki/chaoskube</li>
<li>https://github.com/powerfulseal/powerfulseal</li>
</ul>
<h2 id="toc_14">load test</h2>
<ul>
<li>https://github.com/mrahbar/k8s-testsuite</li>
</ul>
<h2 id="toc_15">notifiers</h2>
<ul>
<li>https://github.com/bitnami-labs/kubewatch</li>
<li>https://github.com/searchlight/searchlight</li>
<li>https://github.com/sukeesh/k8s-job-notify</li>
<li>https://github.com/infracloudio/botkube</li>
</ul>
<h2 id="toc_16">web-cli</h2>
<ul>
<li>https://github.com/kubernetes-sigs/kui</li>
</ul>
<h2 id="toc_17">desktop</h2>
<ul>
<li>https://github.com/lensapp/lens</li>
<li>https://github.com/kubenav/kubenav</li>
<li>https://github.com/skippbox/skippbox</li>
</ul>
<h2 id="toc_18">linter</h2>
<ul>
<li>https://github.com/instrumenta/kubeval</li>
<li>https://github.com/stackrox/kube-linter</li>
<li>https://github.com/zegl/kube-score</li>
</ul>
<h2 id="toc_19">web dashboard</h2>
<ul>
<li>https://github.com/kubernetes/dashboard</li>
<li>https://github.com/rancher/rancher</li>
<li>https://github.com/kubevious/kubevious</li>
<li>https://github.com/vmware-tanzu/octant</li>
</ul>
<h2 id="toc_20">web dashboard (novos projetos)</h2>
<ul>
<li>https://github.com/skooner-k8s/skooner</li>
<li>https://github.com/jeremykross/konstellate</li>
<li>https://github.com/smpio/kubernator</li>
</ul>
<h2 id="toc_21">ci/cd system</h2>
<ul>
<li>https://github.com/fluxcd/flux</li>
<li>https://github.com/argoproj/argo-cd</li>
<li>https://github.com/werf/werf</li>
<li>https://github.com/tektoncd/operator</li>
</ul>
<h2 id="toc_22">ci/cd tool</h2>
<ul>
<li>https://githubhelp.com/alexcurtin/kubernetes-deploy</li>
</ul>
<h2 id="toc_23">developer</h2>
<ul>
<li>https://github.com/tilt-dev/tilt</li>
</ul>
<h2 id="toc_24">kubernetes local</h2>
<ul>
<li>https://github.com/rancher/k3d</li>
<li>https://github.com/kubernetes/minikube</li>
<li>https://github.com/kubernetes-sigs/kind</li>
</ul>
<h2 id="toc_25">kubernetes installers</h2>
<ul>
<li>https://github.com/kubernetes/kops</li>
</ul>
<h2 id="toc_26">kubernetes distros</h2>
<ul>
<li>https://rancher.com/products/rke</li>
<li>https://github.com/kubernetes/kubeadm</li>
</ul>
<h2 id="toc_27">security (cli)</h2>
<ul>
<li>https://github.com/aquasecurity/kube-bench</li>
<li>https://github.com/aquasecurity/kube-hunter</li>
<li>https://github.com/aquasecurity/kubectl-who-can</li>
<li>https://github.com/aquasecurity/trivy</li>
<li>https://github.com/armosec/kubescape</li>
<li>https://github.com/FairwindsOps/Pluto</li>
<li>https://github.com/derailed/popeye</li>
</ul>
<h2 id="toc_28">service proxy</h2>
<ul>
<li>https://github.com/envoyproxy/envoy</li>
<li>https://github.com/projectcontour/contour</li>
<li>https://github.com/traefik/traefik</li>
<li>https://github.com/nginx/nginx</li>
</ul>
<h2 id="toc_29">storage (block)</h2>
<ul>
<li>https://github.com/longhorn/longhorn</li>
<li>https://github.com/openebs/openebs</li>
</ul>
<h2 id="toc_30">storage (object)</h2>
<ul>
<li>https://github.com/minio/minio</li>
</ul>
<h2 id="toc_31">service mesh</h2>
<ul>
<li>https://github.com/linkerd/linkerd2</li>
<li>https://github.com/istio/istio</li>
<li>https://github.com/hashicorp/consul</li>
</ul>
<h2 id="toc_32">packages</h2>
<ul>
<li>https://github.com/helm/helm</li>
<li>https://github.com/kubernetes-sigs/kustomize/</li>
<li>https://github.com/buildpacks/pack</li>
</ul>
<h2 id="toc_33">container register</h2>
<ul>
<li>https://github.com/goharbor/harbor</li>
<li>https://github.com/quay/quay</li>
</ul>
<h2 id="toc_34">database</h2>
<ul>
<li>https://github.com/ongres/stackgres</li>
<li>https://github.com/CrunchyData/postgres-operator</li>
<li>https://github.com/vitessio/vitess</li>
</ul>
<h2 id="toc_35">api gateway</h2>
<ul>
<li>https://github.com/emissary-ingress/emissary</li>
<li>https://github.com/Kong/kong</li>
</ul>
<h2 id="toc_36">observability</h2>
<ul>
<li>https://github.com/pulumi/kubespy</li>
<li>https://github.com/salesforce/sloop</li>
</ul>
<h2 id="toc_37">troubleshooting</h2>
<ul>
<li>https://github.com/aylei/kubectl-debug</li>
</ul>
<h2 id="toc_38">telemetria</h2>
<ul>
<li>https://github.com/jaegertracing/jaeger</li>
<li>https://github.com/open-telemetry</li>
<li>https://github.com/opentracing</li>
<li>https://grafana.com/oss/tempo</li>
</ul>
<h2 id="toc_39">serverless</h2>
<ul>
<li>https://github.com/kubeless/kubeless</li>
<li>https://github.com/funktionio/funktion</li>
<li>https://github.com/fission</li>
<li>https://github.com/openfaas/faas</li>
</ul>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Verificando quando uma branch foi criada!</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/verificando-quando-uma-branch-foi-criada/"/>
        <id>https://gutocarvalho.net/verificando-quando-uma-branch-foi-criada/</id>
            <category term="MindNotes"/>

        <updated>2022-01-06T12:59:17-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Nota mental para verificar a idade e o autor de uma branch.</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Nota mental para verificar a idade e o autor de uma branch.</p>

<h2 id="toc_0">Checando quando uma branch foi criada</h2>
<p>Para verificar quando uma branch foi criada</p>
<div>
<pre class=" language-none"><code class=" language-none">$ git for-each-ref --sort=authordate --format '%(authordate:iso) %(align:left,25)%(refname:short)%(end) %(subject)' refs/heads</code></pre>
</div>
<p>exemplo saída</p>
<div>
<pre class=" language-none"><code class=" language-none">2021-11-18 09:54:39 -0500 production                Added bugsnag configuration
2022-01-05 14:35:47 -0300 dockerize                 Added shipit production config</code></pre>
</div>
<h2 id="toc_1">Checando quem criou cada branch</h2>
<div>
<pre class=" language-none"><code class=" language-none">$ git for-each-ref --format='%(color:cyan)[data] %(authordate:format:%m/%d/%Y %I:%M %p) %(color:green) [branch] %(refname:short) %(align:25,left)%(color:yellow)[author] %(authorname)%(end) %(color:reset)%(refname:strip=3)' --sort=authordate refs/heads</code></pre>
</div>
<p>exemplo de saída</p>
<div>
<pre class=" language-none"><code class=" language-none">[data] 11/18/2021 09:54 AM  [branch] production [author] Jose Augusto
[data] 01/05/2022 02:35 PM  [branch] dockerize [author] Guto Carvalho</code></pre>
</div>
<p>Este post é do tipo #MindNotes, entenda <a href="https://gutocarvalho.net/o-que-sao-mindnotes/">aqui</a>.</p>
<h2 id="toc_2">References</h2>
<ul>
<li>https://www.code-helper.com/answers/check-age-of-git-branch</li>
</ul>
<p>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>O que são TLDR&#x27;s ?</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/o-que-sao-tldrs/"/>
        <id>https://gutocarvalho.net/o-que-sao-tldrs/</id>

        <updated>2022-01-06T11:01:53-03:00</updated>
            <summary>
                <![CDATA[
                    TLDR significa "Too Long Don't Read", é uma expressão é inglês para&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>TLDR significa "Too Long Don't Read", é uma expressão é inglês para o termo brazuca <strong>textão</strong>.</p>
<p>Alguns temas aqui são TLDR, geralmente pois o assunto demanda muito texto para explicar um conceito, modelo ou tecnologia.<br><br>Então já sabe, se o post é TLDR pega a água e um lanchinho e vem!</p>
<p><br>:)</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>O que são #MindNotes ?</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/o-que-sao-mindnotes/"/>
        <id>https://gutocarvalho.net/o-que-sao-mindnotes/</id>

        <updated>2022-01-06T11:01:51-03:00</updated>
            <summary>
                <![CDATA[
                    Mindnotes, como o nome diz são notas mentais rápidas de algo que&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p><strong>Mindnotes,</strong> como o nome diz são notas mentais rápidas de algo que eu preciso estudar, pesquisar, entender ou lembrar. <br><br>Pode ser um post de uma linha, de um link, ou até um parágrafo, rápido e direto!<br><br>Normalmente vira um <a href="https://gutocarvalho.net/o-que-sao-drops/">DROPS</a> ou um <a href="https://gutocarvalho.net/o-que-sao-tldrs/">TLDR</a> no futuro.<br><br>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>O que são #Drops?</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/o-que-sao-drops/"/>
        <id>https://gutocarvalho.net/o-que-sao-drops/</id>

        <updated>2022-01-06T10:46:48-03:00</updated>
            <summary>
                <![CDATA[
                    São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam.
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>São DUMPs mentais rápidos e rasteiros, simples e objetivos – que funcionam. <br><br>Geralmente de algo que eu acabei de fazer.<br><br>Eu – quase sempre – volto para detalhar mais cada passo.<br><br>Considere com a mesma qualidade de um rascunho ou uma anotação rápida.<br><br>De qualquer forma comenta ai qquer coisa, os comentários estão ligados nos DROPS ;)<br><br>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Organizando e tornando o kubeconfig interativo!</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/organizando-e-tornando-o-kubeconfig-interativo/"/>
        <id>https://gutocarvalho.net/organizando-e-tornando-o-kubeconfig-interativo/</id>
            <category term="Projetos"/>
            <category term="K8S"/>
            <category term="Drops"/>

        <updated>2022-01-06T10:56:36-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Aprenda a organizar seu kubeconfig!</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Aprenda a organizar seu kubeconfig!</p>

<p>Qual a melhor forma de organizar múltiplos clientes e projetos para administrar seus clusters?</p>
<p>Sabemos que o kubectl precisa de um kubeconfig para funcionar, podemos apontar diretamente e executar algo</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl --kubeconfig=arquivo_de_config get nodes</code></pre>
</div>
<p>Podemos usar também a variável kubeconfig</p>
<div>
<pre class=" language-none"><code class=" language-none">$ export KUBECONFIG=/caminho/para/arquivo/config
$ kubect get nodes</code></pre>
</div>
<p>E como eu faço para dar conta de gerenciar dezenas de projetos e clientes?</p>
<div>
<pre class=" language-none"><code class=" language-none">Eu uso o kubectx + kubens + fzf + kubectl-import, falaremos disso a frente :)</code></pre>
</div>
<p>Primeira coisa que você tem que pensar é que um único arquivo de kubeconfig é suficiente para todos os seus projetos, inclusive o arquivo foi pensado para ter diferentes contextos.</p>
<p>Primeiro vamos entender como funciona esse arquivo e seus contextos.</p>
<h3 id="toc_0">Entendendo contextos</h3>
<p>Veja um exemplo simples de arquivo de configuração do kubectl com diferentes contextos</p>
<div>
<pre class=" language-none"><code class=" language-none">apiVersion: v1
kind: Config
preferences: {}

clusters:
- cluster:
  name: prd
- cluster:
  name: dev
- cluster:
  name: tst
- cluster:

  
users:
- name: engineers
- name: developers
- name: testers

contexts:
- context:
  name: production-cluster
    user: name
    cluster: prd
- context:
  name: dev-cluster
    user: name
    cluster: dev
- context:
  name: test-cluster
    user: name
    cluster: tst</code></pre>
</div>
<p>Agora vamos aprender a criar esse arquivo passo a passo.</p>
<h3 id="toc_1">Adicionando clusters</h3>
<p>Adicionando cluster <strong>prd</strong> com certificado CA</p>
<div>
<pre class=" language-none"><code class=" language-none"> $ kubectl config --kubeconfig=config set-cluster projeto-prd --server=https://192.168.222.80 --certificate-authority=prd-cert-file</code></pre>
</div>
<p>Adicionando cluster <strong>dev</strong> com certificado CA</p>
<div>
<pre class=" language-none"><code class=" language-none"> $ kubectl config --kubeconfig=config set-cluster projeto-dev --server=https://172.16.31.20 --certificate-authority=dev-cert-file</code></pre>
</div>
<p>Adicionando cluster <strong>tst</strong> e ignorando o certificado</p>
<div>
<pre class=" language-none"><code class=" language-none"> $ kubectl config --kubeconfig=config set-cluster projeto-tst --server=https://10.200.3.90 --certificate-authority=tst-ca-file</code></pre>
</div>
<h3 id="toc_2">Adicionando usuários</h3>
<p>Adicionando usuário para engenheiros com certificado</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config set-credentials engineers --client-certificate=eng-cert-file --client-key=eng-key-file</code></pre>
</div>
<p>Adicionando usuário para desenvolvedores com certificado</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config set-credentials developers --client-certificate=dev-cert-file --client-key=dev-key-file</code></pre>
</div>
<p>Adicionando usuário para testadores com user/senha</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config set-credentials testers --username=admin --password=password</code></pre>
</div>
<h3 id="toc_3">Adicionando contextos</h3>
<p>Adicionando contexto para cluster de <strong>produção</strong> com usuário engineers</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config set-context cluster-projeto-prd --cluster=projeto-prd --user=engineers</code></pre>
</div>
<p>Adicionando contexto para cluster de <strong>desenvolvimento</strong> com usuário developer</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config set-context cluster-projeto-dev --cluster=projeto-dev --user=developers</code></pre>
</div>
<p>Adicionando contexto para cluster de <strong>teste</strong> com usuário testers</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config set-context cluster-projeto-tst --cluster=projeto-tst --user=testers</code></pre>
</div>
<h3 id="toc_4">Verificando arquivo</h3>
<p>Leia o arquivo</p>
<div>
<pre class=" language-none"><code class=" language-none">$ cat config</code></pre>
</div>
<p>Agora você provavelmente tem um arquivo como esse, acredito que a única diferença para o seu é que eu coloquei o kind e preferences no topo.</p>
<div>
<pre class=" language-none"><code class=" language-none">apiVersion: v1
kind: Config
preferences: {}
clusters:
- cluster:
    certificate-authority: dev-cert-file
    server: https://172.16.31.20
  name: projeto-dev
- cluster:
    certificate-authority: prd-cert-file
    server: https://192.168.222.80
  name: projeto-prd
- cluster:
    certificate-authority: tst-ca-file
    server: https://10.200.3.90
  name: projeto-tst
contexts:
- context:
    cluster: projeto-dev
    user: developers
  name: cluster-projeto-dev
- context:
    cluster: projeto-prd
    user: engineers
  name: cluster-projeto-prd
- context:
    cluster: projeto-tst
    user: testers
  name: cluster-projeto-tst
current-context: ""
users:
- name: developers
  user:
    client-certificate: dev-cert-file
    client-key: dev-key-file
- name: engineers
  user:
    client-certificate: eng-cert-file
    client-key: eng-key-file
- name: testers
  user:
    password: password
    username: admin</code></pre>
</div>
<p>Agora que os contextos foram configurados, podemos mudar de contexto assim.</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config use-context cluster-projeto-prd</code></pre>
</div>
<p>E a partir daí qualquer comando do kubectl será realizado no cluster configurado nesse contexto.</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubeclt --kubeconfig=config get nodes</code></pre>
</div>
<p>Exemplo de saída</p>
<div>
<pre class=" language-none"><code class=" language-none">k8s-prd-ctl-01      Ready    controlplane,etcd   6d1h   v1.21.7
k8s-prd-ctl-02      Ready    controlplane,etcd   6d1h   v1.21.7
k8s-prd-ctl-03      Ready    controlplane,etcd   6d1h   v1.21.7
k8s-prd-ctl-04      Ready    controlplane,etcd   6d1h   v1.21.7
k8s-prd-ctl-05      Ready    controlplane,etcd   6d1h   v1.21.7
k8s-prd-worker-01   Ready    worker              6d1h   v1.21.7
k8s-prd-worker-02   Ready    worker              6d1h   v1.21.7
k8s-prd-worker-03   Ready    worker              6d1h   v1.21.7
k8s-prd-worker-04   Ready    worker              6d1h   v1.21.7</code></pre>
</div>
<h3 id="toc_5">Verificando a configuração do kubectl</h3>
<p>Com o comando abaixo você verá a configuração completa</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config view</code></pre>
</div>
<h3 id="toc_6">Verificando apenas do contexto que está configurado</h3>
<p>É preciso usar o parâmetro minify para limitar ao contexto escolhido</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl config --kubeconfig=config view --minify</code></pre>
</div>
<p>Saída</p>
<div>
<pre class=" language-none"><code class=" language-none">apiVersion: v1
clusters:
- cluster:
    certificate-authority: prd-cert-file
    server: https://192.168.222.80
  name: projeto-prd
contexts:
- context:
    cluster: projeto-prd
    user: engineers
  name: cluster-projeto-prd
current-context: cluster-projeto-prd
kind: Config
preferences: {}
users:
- name: engineers
  user:
    client-certificate: eng-cert-file
    client-key: eng-key-file</code></pre>
</div>
<p>Observe a linha</p>
<div>
<pre class=" language-none"><code class=" language-none">current-context: cluster-projeto-prd</code></pre>
</div>
<p>Sempre que alteramos de contexto essa linha será modificado no seu arquivo de configuração.</p>
<h3 id="toc_7">Existe algo mais prático para visualizar e trocar de contextos?</h3>
<p>Sim, existe o projeto kubectx</p>
<ul>
<li>https://github.com/ahmetb/kubectx</li>
</ul>
<p>Instalando via brew</p>
<div>
<pre class=" language-none"><code class=" language-none">$ brew install kubectx</code></pre>
</div>
<p>Rodando</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectx</code></pre>
</div>
<p>Ele vai te mostrar os contextos disponíveis</p>
<div>
<pre class=" language-none"><code class=" language-none">cluster-projeto-prd
cluster-projeto-dev
cluster-projeto-tst</code></pre>
</div>
<p>Para escolher o contexto basta digitar</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectx cluster-projeto-prd</code></pre>
</div>
<p>E pronto!</p>
<h3 id="toc_8">Existe algo ainda mais fácil?</h3>
<p>Sim, você pode utilizar o projeto fzf</p>
<ul>
<li>https://github.com/junegunn/fzf</li>
</ul>
<p>Instalando via brew</p>
<div>
<pre class=" language-none"><code class=" language-none">$ brew install fzf</code></pre>
</div>
<p>Com ele o kubectx fica interativo, abre um menu e você seleciona o contexto.</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectx</code></pre>
</div>
<p>Saída</p>
<p>
<script id="asciicast-NC0R8SqNRzcjpJl0j5B1iB7Ja" src="https://asciinema.org/a/NC0R8SqNRzcjpJl0j5B1iB7Ja.js" async=""></script>
</p>
<h3 id="toc_9">Consigo importar um kubeconfig?</h3>
<p>Eu sei que ficar editando isso na mão dá um certo trabalho, mas tem solução. Recentemente eu encontrei o projeto kubectl-import para resolver essa questão.</p>
<ul>
<li>https://github.com/bitnami-labs/kubectl-import</li>
</ul>
<p>Instalando o projeto</p>
<div>
<pre class=" language-none"><code class=" language-none"> $ sudo curl -o kubectl-import https://raw.githubusercontent.com/bitnami-labs/kubectl-import/master/kubectl-import &amp;&amp; chmod 0755 kubectl-import</code></pre>
</div>
<p>Com ele você consegue pegar um kubeconfig e importar</p>
<div>
<pre class=" language-none"><code class=" language-none"> $ export KUBECONFIG=/caminho/pro/seu/kubeconfig
 $ ./kubectl-import kubeconfig-novo</code></pre>
</div>
<p>E pronto, o novo cluster/contexto vai aparecer no seu kubectx. Recomendo editar o arquivo antes de importar, setando corretamente os nomes do cluster, user e contexto.</p>
<h3 id="toc_10">Tem algo parecido como kubectx só que para namespaces?</h3>
<p>Tem sim, o projeto kubectx traz junto o kubens, aplicativo similar que serve para trocar de namespaces rapidamente de forma interativa, basta digitar</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubens</code></pre>
</div>
<p>E escolher o namespace.</p>
<h2 id="toc_10">Amarrando as pontas</h2>
<p>Espero que tenha aprendido a usar contextos do kubeconf, usar o kubectx, fzf, kubectl-import e agilizar a administração de seus clusters.<br><br>Esse post é o que eu chamo de DROPS, entenda o modelo <a href="https://gutocarvalho.net/o-que-sao-drops/">aqui</a>.</p>
<p>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Sistemas de comentários open source</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/sistemas-de-comentarios-open-source/"/>
        <id>https://gutocarvalho.net/sistemas-de-comentarios-open-source/</id>
            <category term="MindNotes"/>

        <updated>2022-01-05T18:21:16-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Eu uso o DISQUS, mas estou buscando alternativas open source!</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Eu uso o DISQUS, mas estou buscando alternativas open source!</p>

<p>Veja alguns sistemas de comentários open source interessantes</p>
<p><a href="https://commento.io/">https://commento.io/</a></p>
<p><a href="https://remark42.com/">https://remark42.com/</a></p>
<p><a href="https://posativ.org/isso/">https://posativ.org/isso/</a></p>
<p><a href="https://github.com/phusion/juvia">https://github.com/phusion/juvia</a></p>
<p><a href="https://github.com/jacobwb/hashover">https://github.com/jacobwb/hashover</a></p>
<p><a href="https://github.com/schn4ck/schnack">https://github.com/schn4ck/schnack</a></p>
<p><a href="https://github.com/xCss/Valine">https://github.com/xCss/Valine</a><br><br><a href="https://github.com/commentics/commentics">https://github.com/commentics/commentics</a><br><br><a href="https://github.com/vkuznecovas/mouthful">https://github.com/vkuznecovas/mouthful</a><br><br><a href="https://cusdis.com/">https://cusdis.com/</a><br><br><a href="https://github.com/gitalk/gitalk">https://github.com/gitalk/gitalk</a></p>
<p>References</p>
<p>- <a href="https://ourcodeworld.com/articles/read/1265/top-7-best-open-source-self-hosted-comment-system-alternatives-to-disqus">https://ourcodeworld.com/articles/read/1265/top-7-best-open-source-self-hosted-comment-system-alternatives-to-disqus</a><br>- <a href="https://lisakov.com/projects/open-source-comments/">https://lisakov.com/projects/open-source-comments/</a><br>- <a href="https://www.findbestopensource.com/tagged/commenting-engine">https://www.findbestopensource.com/tagged/commenting-engine</a><br>- <a href="https://nestify.io/blog/11-best-disqus-alternatives-you-should-try">https://nestify.io/blog/11-best-disqus-alternatives-you-should-try</a></p>
<p>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Usando o kubetail para ver logs no K8S</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/usando-o-kubetail-para-ver-logs-no-k8s/"/>
        <id>https://gutocarvalho.net/usando-o-kubetail-para-ver-logs-no-k8s/</id>
            <category term="K8S"/>
            <category term="Drops"/>

        <updated>2022-01-06T10:22:41-03:00</updated>
            <summary>
                <![CDATA[
                    As vezes queremos ver os logs de todos os pods de um&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>As vezes queremos ver os logs de todos os pods de um mesmo namespace, usando apenas o kubectl essa tarefa pode ser difícil, para isso podemos recorrer a ferramentas externas como o kubetail</p>
<p>Instalando via homebrew</p>
<div>
<pre class=" language-none"><code class=" language-none">$ brew tap johanhaleby/kubetail &amp;&amp; brew install kubetail</code></pre>
</div>
<p>Procurando por pods em um namespace</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubectl get pods -n project</code></pre>
</div>
<p>Saída</p>
<div>
<pre class=" language-none"><code class=" language-none">NAME                   READY     STATUS    RESTARTS   AGE
api-backend-v1-aba8y   1/1       Running   0          1d
api-backend-v1-gc4st   1/1       Running   0          1d
api-backend-v1-m8acl   1/1       Running   0          6d
api-frontend-v31-s20d0 1/1       Running   0          1d
api-frontend-v31-9pbpn 1/1       Running   0          1d
api-frontend-v31-q74wg 1/1       Running   0          1d
database-v5-0fa8o      1/1       Running   0          3h
database-v5-yhren      1/1       Running   0          2h</code></pre>
</div>
<p>Fazendo tail nos logs dos pods api-backend</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubetail api-backend -n project</code></pre>
</div>
<p>Fazendo tail nos logs do primeiro container nos pods api-backend</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubetail api-backend -c container1 -n project</code></pre>
</div>
<p>Fazendo tail nos logs do container 1 e 2 dos pods api-backend</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubetail api-backend -c container1 -c container2 -n project</code></pre>
</div>
<p>Fazendo tail dos logs dos pods api-backend e api-frontend</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubetail api-backend,api-frontend -n project</code></pre>
</div>
<p>Fazendo tail no que casar com a expressão regular abaixo</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubetail "^api|.*database.*" --regex -n project</code></pre>
</div>
<p>Fazendo tail dos logs de todos os pods do namesapce project</p>
<div>
<pre class=" language-none"><code class=" language-none">$ kubetail -n project</code></pre>
</div>
<h2 id="toc_0">References</h2>
<ul>
<li>https://github.com/johanhaleby/kubetail</li>
</ul>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Revelando secrets com o ksd</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/revelando-secrets-com-o-ksd/"/>
        <id>https://gutocarvalho.net/revelando-secrets-com-o-ksd/</id>
            <category term="K8S"/>
            <category term="Drops"/>

        <updated>2022-01-06T10:22:51-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Conhece o projeto ksd? Então vem conhecer!</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Conhece o projeto ksd? Então vem conhecer!</p>

<p>Repo do projeto<br><br>- <a href="#INTERNAL_LINK#/post/null">https://github.com/mfuentesg/ksd</a></p>
<p>Quando damos um get em um secret temos isso aqui</p>
<pre>$ kubectl get secret &lt;secret name&gt; -o &lt;yaml|json&gt;</pre>
<p>Saída</p>
<pre>{
    <span class="pl-ent">"apiVersion"</span>: <span class="pl-s"><span class="pl-pds">"</span>v1<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"data"</span>: {
        <span class="pl-ent">"password"</span>: <span class="pl-s"><span class="pl-pds">"</span>c2VjcmV0<span class="pl-pds">"</span></span>,
        <span class="pl-ent">"app"</span>: <span class="pl-s"><span class="pl-pds">"</span>a3ViZXJuZXRlcyBzZWNyZXQgZGVjb2Rlcg==<span class="pl-pds">"</span></span>
    },
    <span class="pl-ent">"kind"</span>: <span class="pl-s"><span class="pl-pds">"</span>Secret<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"metadata"</span>: {
        <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>kubernetes secret decoder<span class="pl-pds">"</span></span>,
        <span class="pl-ent">"namespace"</span>: <span class="pl-s"><span class="pl-pds">"</span>ksd<span class="pl-pds">"</span></span>
    },
    <span class="pl-ent">"type"</span>: <span class="pl-s"><span class="pl-pds">"</span>Opaque<span class="pl-pds">"</span></span>
}</pre>
<p>Quando usamos o ksd ele vira texto puro</p>
<pre>$ kubectl get secret &lt;secret name&gt; -o &lt;yaml|json&gt; | ksd</pre>
<p>Saída</p>
<pre>{
    <span class="pl-ent">"apiVersion"</span>: <span class="pl-s"><span class="pl-pds">"</span>v1<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"data"</span>: {
        <span class="pl-ent">"password"</span>: <span class="pl-s"><span class="pl-pds">"</span>secret<span class="pl-pds">"</span></span>,
        <span class="pl-ent">"app"</span>: <span class="pl-s"><span class="pl-pds">"</span>kubernetes secret decoder<span class="pl-pds">"</span></span>
    },
    <span class="pl-ent">"kind"</span>: <span class="pl-s"><span class="pl-pds">"</span>Secret<span class="pl-pds">"</span></span>,
    <span class="pl-ent">"metadata"</span>: {
        <span class="pl-ent">"name"</span>: <span class="pl-s"><span class="pl-pds">"</span>kubernetes secret decoder<span class="pl-pds">"</span></span>,
        <span class="pl-ent">"namespace"</span>: <span class="pl-s"><span class="pl-pds">"</span>ksd<span class="pl-pds">"</span></span>
    },
    <span class="pl-ent">"type"</span>: <span class="pl-s"><span class="pl-pds">"</span>Opaque<span class="pl-pds">"</span></span>
}</pre>
<p>Legal né?<br><br>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Gracefully shutdown pods</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/gracefully-shutdown-pods/"/>
        <id>https://gutocarvalho.net/gracefully-shutdown-pods/</id>
            <category term="MindNotes"/>

        <updated>2021-12-15T09:07:05-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Olha esse post aqui explica direitinho, lê aí.</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Olha esse post aqui explica direitinho, lê aí.</p>

<p>Post!<br><br><a href="https://blog.gruntwork.io/gracefully-shutting-down-pods-in-a-kubernetes-cluster-328aecec90d">https://blog.gruntwork.io/gracefully-shutting-down-pods-in-a-kubernetes-cluster-328aecec90d</a></p>
<p>[s]</p>
            ]]>
        </content>
    </entry>
</feed>
