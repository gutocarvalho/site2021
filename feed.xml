<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>Guto@Site</title>
    <link href="https://gutocarvalho.net/feed.xml" rel="self" />
    <link href="https://gutocarvalho.net" />
    <updated>2022-04-14T16:17:31-03:00</updated>
    <author>
        <name>Guto Carvalho</name>
    </author>
    <id>https://gutocarvalho.net</id>

    <entry>
        <title>Nova Bridge para Telegram e Discord</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/nova-bridge-para-telegram-e-discord/"/>
        <id>https://gutocarvalho.net/nova-bridge-para-telegram-e-discord/</id>
            <category term="MindNotes"/>

        <updated>2022-04-14T16:17:31-03:00</updated>
            <summary>
                <![CDATA[
                    Agora estamos usando o projeto TediCross para conectar Telegram e Discord. O&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Agora estamos usando o projeto <strong>TediCross</strong> para conectar Telegram e Discord. O projeto é feito em NodeJS, se mostrou mais leve e estável que o matterbridge que estava apresentando muitos problemas de rede e timeout.</p>
<p>Seguimos com o <strong>MatterBridge</strong> (escrito em GO) entre Matrix e Discord, esse ainda está valendo a pena.</p>
<p>Conheça o projeto </p>
<ul>
<li><a href="https://github.com/TediCross/TediCross">https://github.com/TediCross/TediCross</a></li>
</ul>
<p>Exemplo de arquivo de configuração</p>
<pre><code>telegram:
  token: SEU_TOKEN_TELEGRAM
  useFirstNameInsteadOfUsername: false
  colonAfterSenderName: false
  skipOldMessages: true
  sendEmojiWithStickers: true
discord:
  useNickname: false
  token: SEU_TOKEN_DISCORD
  skipOldMessages: true
  replyLength: 100
  maxReplyLines: 2
bridges:
  - name: valida-bridge
    direction: both
    telegram:
      chatId: -1001707735774
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955441656465879100&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: devops-br
    direction: both
    telegram:
      chatId: -1001423205502
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421330038226984&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: docker-br
    direction: both
    telegram:
      chatId: -1001020429061
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421304515887135&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: cloudnative-br
    direction: both
    telegram:
      chatId: -1001375583910
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421395645497375&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: cicd-br
    direction: both
    telegram:
      chatId: -1001283833531
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421395645497375&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: gitlab-br
    direction: both
    telegram:
      chatId: -1001116126565
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421455598891049&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: terraform-br
    direction: both
    telegram:
      chatId: -1001141750151
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421523404021822&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: packer-br
    direction: both
    telegram:
      chatId: -1001496751272
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421501576851526&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: ansible-br
    direction: both
    telegram:
      chatId: -1001112694111
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421554383138846&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true 
  - name: devosdays-br
    direction: both
    telegram:
      chatId: -1001109056730
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955426512176287834&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true 
  - name: gitops-br
    direction: both
    telegram:
      chatId: -1001375992764
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955421349273292870&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: macusers-br
    direction: both
    telegram:
      chatId: -1001052488672
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955564437555781682&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: tecladomecanico
    direction: both
    telegram:
      chatId: -1001208515699
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955564291665309726&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: homeservers
    direction: both
    telegram:
      chatId: -1001178428134
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;956331120247599144&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: vagas
    direction: both
    telegram:
      chatId: -1001682001563
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955598939380387950&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
  - name: conduta
    direction: both
    telegram:
      chatId: -1001095406242
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      relayCommands: true
      crossDeleteOnDiscord: true
    discord:
      channelId: &#39;955573278796300318&#39;
      relayJoinMessages: false
      relayLeaveMessages: false
      sendUsernames: true
      crossDeleteOnTelegram: true
debug: true
</code></pre>
<p>That’s it!</p>
<p>[s]
Guto</p>

            ]]>
        </content>
    </entry>
    <entry>
        <title>Qual curso de TI eu devo fazer em 2022?</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/qual-curso-de-ti-eu-devo-fazer-em-2022/"/>
        <id>https://gutocarvalho.net/qual-curso-de-ti-eu-devo-fazer-em-2022/</id>
            <category term="FalaGutera"/>

        <updated>2022-04-14T14:07:51-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Bom bom bom... eis a questão!</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Bom bom bom... eis a questão!</p>

<p>Tantos cursos, o que eu devo fazer em 2022?<br><br>Se você quer entrar logo no mercado de trabalho, e fazer um curso mais focado no que você vai ver aqui fora da faculdade, eu posso te dar algumas sugestões.<br><br><strong>Cenário 1 (Preciso resolver isso rápido)</strong><br><br>Se você tem contas para pagar, se ajuda nas contas da casa, se tem gente para sustentar e tá precisando <strong>pivotar</strong> e começar rápido em outra área, os cursos de <strong>tecnólogo</strong> são para você.<br><br>Em caso de um foco maior no lado de INFRA eu iria de:<br><br>- Tecn. Computação em Nuvem<br>- Tecn. DevOps<br>- Tecn. Cybersecurity <br><br>Em caso de algo com foco maior em DEV eu iria de:<br><br>- Tecn. Backend<br>- Tecn. Web<br>- Tecn. Mobiles<br><br>Outras areas interessantes:<br><br>- Ciência de dados<br><br>Cursos de tecnólogo que eu não recomendo + fazer hoje:<br><br>- Tecn. AD Sistemas<br>- Tecn. Redes<br>- Tecn. Gestão da Informação<br><br>Eu acho que já foi o tempo deles e acho que precisam de um reboot. E no meu caso, eu recomendo algo para quem quer FIT com o mercado, se for esse seu caso vai nos de cima, tem vaga sobrando, paga bem, tá mais alinhado com a realidade do mundo hoje.<br><br><strong>Cenário 2 (minha vida tá em paz)</strong></p>
<p>Se você mora com alguém, não paga contas, não ajuda com as tarefas da casa, tem o que comer, beber e vestir e pode até se dar ao luxo de se divertir. Se alguém te banca de alguma forma (financeiramente), se alguém pode pagar os seus estudos e deixar você focar em estudar, e além de tudo isso, se você quer estudar COMPUTAÇÃO a FUNDO, não importando quantos semestres sejam, eu indicaria os cursos de bacharelado:<br><br><span style="text-decoration: underline;"><em>Na área de engenharia e desenvolvimento</em></span><br><br>- Engenharia da computação<br>- Engenharia de software<br>- Engenharia de telecomunicações<br><br>Tags: sistemas operacionais, redes, programação, hardware, elétrica e eletrônica<br><br><span style="text-decoration: underline;"><em>Na área de ciência e desenvolvimento</em></span><br><br>- Ciência da computação <br>- Sistemas da informação<br><br>Tags: sistemas operacionais, redes, programação<br><br>Esse seria um resumo do resumo, o assunto é denso, complexo, cada curso tem um objetivo e um propósito, precisa estudar tudo com calma e cuidado, contudo, eu acho que isso aqui já dá um norte melhor que uma mensagem de 280 caracteres no twitter :)<br><br><strong>Cenário 3 (E se eu quiser estudar por conta, isso rola?)</strong><br><br>Rola, claro, isso é o que chamamos de um processo de <strong>autodidaxia</strong>, eu começaria por aqui.<br><br>- <a href="https://gomex.me/mentoriaiac/">mentoria IaC</a><br>- <a href="https://www.linuxtips.io/">linuxtips</a><br><br>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Tomei um exposed do @badtux_</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/tomei-um-exposed-do-badtux/"/>
        <id>https://gutocarvalho.net/tomei-um-exposed-do-badtux/</id>
            <category term="FalaGutera"/>

        <updated>2022-04-06T08:46:51-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Não é todo dia que a gente toma, mas esse é uma honra :)</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Não é todo dia que a gente toma, mas esse é uma honra :)</p>

<p>Eis que eu estava ontem na rua, resolvendo questões da vida, universo e tudo mais, de boas, e do nada o meu celular começou a pipocar notificação de todas as redes sociais possíveis e imagináveis, tudo graças a um EXPOSED do grande @Badtux_</p>
<p>Muito obrigado meu parceiro e conte comigo sempre!</p>
<figure class="post__video"><iframe loading="lazy" width="658" height="367" style="width: 658px; height: 367px;" src="https://www.youtube.com/embed/_Ah-pipPCQk" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe></figure>
<p>Ainda não conhece o @badtux_ e a #LinuxTips?<br><br>Demoro, cola lá <a href="https://www.linuxtips.io/">https://www.linuxtips.io/</a><br><br>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Multiwan em Casa</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/multiwan-em-casa-comofaz/"/>
        <id>https://gutocarvalho.net/multiwan-em-casa-comofaz/</id>
            <category term="FalaGutera"/>

        <updated>2022-04-03T18:20:44-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Quer usar dois provedores, mas não sabe por onde começar? Só vem!</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Quer usar dois provedores, mas não sabe por onde começar? Só vem!</p>

<p><strong>Multi-WAN + Balanceamento de Links</strong></p>
<p>Alguns profissionais – como eu – usam dois provedores para garantir que possam trabalhar sem interrupção em seu home office.</p>
<p>Apesar de ter dois provedores, nem tudo são flores, ficar trocando de modem ou rede sem fio pode ser beeeem chato, além do que a rede WIFI de um dispositivo vai interferir na outra, e mesmo que use cabos, ficar trocando o cabo de rede não é lá muito prático, em especial se está no meio de uma reunião, apresentação ou procedimento.<br><br>Para que a gente não passe por esses problemas, e para que a mudança de provedor ocorra de forma transparente, sem mexer com cabos ou trocar de rede sem fio, é preciso de um roteador <strong>multi-wan</strong> com balanceamento de links e também de um sistema wifi independente, de preferência com a tecnologia MESH.<br><br>Na minha primeira aventura nesse meio usei equipamentos da TP-Link<br><br>- TP-Link Router <strong>R600VPN</strong> para receber e balancear os dois links<br>- TP-Link Switch <strong>SG108E</strong> 16 Portas Gigabit para ligar todos os dispositivos<br>- TP-Link Antenas WIFI <strong>Deco M5</strong> ( 3 unidades )<br><br>Depois de alguns anos busquei algo mais flexível e profissional e adotei a UNIFI<br><br>- Unifi <strong>USG</strong> como roteador para receber e balancear os dois links<br>- Unifi <strong>Switch8-60W</strong> para ligar todos os dispositivos e quartos<br>- Unifi Antenas WIFI <strong>UAP-AC-M-BR</strong> Mesh AC ( 2 unidades )<br><br><strong>E o provedor?</strong><br><br>É um pouco complexo conseguir retirar o dipositivo do provedor, alguns não concordam, então nesse caso basta desligar o WIFI dos dispositivos existentes, conectar seus novos equipamentos e usar o WIFI do seu sistema independente MESH.<br><br>Caso o provedor concorde em tirar o equipamento deles e deixar você discar PPPOE diretamente, o ideal é comprar um equipamento de conversão de FIBRA para ETHERNET do tipo GPON ou EPON, cada caso é um caso, isso vai depender da tecnologia do seu provedor.<br><br><strong>Curiosidades do meu cenário</strong><br><br>Aqui eu uso dois provedores de fibra, cada um vem de uma cidade diferente, em fibras independentes. O provedor principal tem IP Fixo oferece 50% de Upload em relação a velocidade contratada. Meu segundo provedor também oferece IP Fixo e 30% de upload em relação a velocidade contratada. Upload pra mim é importante por causa das Lives então o principal é o que tem mais upload, sempre.<br><br>Na maioria dos casos, o pessoal prefere usar o provedor de backup em planos com 50% ou até 33% (1/3) da capacidade do plano principal, até para reduzir custos, mas varia de cada tipo de usuário. Eu que sou power user, os planos são quase os mesmos. Aqui em casa eu não posso falhar, se perder internet levo de 45 minutos a 1 hora para chegar em algum home office que tenha link bom o suficiente para eu conseguir trabalhar.<br><br><strong>Estratégias</strong><br><br>Podemos definir um <strong>balanceamento continuo </strong>entre os dois provedores ou então deixar o segundo como <strong>failover</strong> (backup), onde só será utilizado no caso de falha do primeiro, vai depender do gosto e necessidade de cada um.<br><br>É possível também criar grupos de dispositivos e definir que alguns vão <strong>sair por um provedor específico,</strong> com isso evitamos que o segundo link fique ocioso em caso de uso em estratégia failover. Aqui em casa eu faço isso aqui, minhas alexas, tvs e smart devices estão pendurados no segundo provedor de forma preferencial.<br><br><strong>Benefícios</strong><br><br>Confesso que eu nem percebo quando o provedor principal cai, é tudo bem transparente, se não fosse o APP no celular avisando eu nem iria saber que algo do tipo aconteceu.<br><br><strong>Referências</strong><br><br>TP-LINK</p>
<p>- Router Multiwan VPN-<a href="https://www.tp-link.com/br/business-networking/vpn-router/er605/">ER605</a><br>- Antenas WIFI MESH <a href="https://www.tp-link.com/br/home-networking/wifi-router/deco-m5/">DECO M5</a><br>- SWITCH 16 Portas <a href="https://www.tp-link.com/br/business-networking/easy-smart-switch/tl-sg108e/">SG108e</a> Gigabit<br><br>UNIFI<br><br>- Router Multiwan UNIFI <a href="https://www.ui.com/unifi-routing/usg/">USG</a><br>- Antenas WIFI UNIFI <a href="https://br.store.ui.com/products/unifi-ac-mesh-ap">AC MESH</a><br>- SWITCH <a href="https://br.store.ui.com/products/unifi-switch-8-60w">UNIFI 8-60W</a> Gigabit</p>
<p><br>[s]<br>Guto<br><br></p>
<p>---<br><br>Este post é do tipo #FalaGutera, entenda <a href="https://gutocarvalho.net/sobre-o-que-e-a-tag-falagutera/">aqui</a>.</p>
<p>Se gostou manda um alo no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a>.<br><br>---<br><br>Se quiser falar comigo estou sempre no DISCORD da <a href="https://discord.gg/9tyRNpKe">#BolhaTech</a> :)<br><br>Aproveite e siga também os profiles abaixo:<br><a href="https://twitter.com/CDeliveryFdn">- CD Foundation</a><br><a href="https://twitter.com/cloudnativefdn">- Cloud Native Foundation</a><br><br>:")</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Canais de TI integrados em 3 redes!</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/canais-de-ti-integrados-em-3-redes/"/>
        <id>https://gutocarvalho.net/canais-de-ti-integrados-em-3-redes/</id>

        <updated>2022-04-14T16:10:08-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Quer saber quais os canais integrados nas 3 redes? Então vem!</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Quer saber quais os canais integrados nas 3 redes? Então vem!</p>

<p><strong>Até o momento temos as comunidades open source abaixo:</strong></p>
<p>#devops-br<br>#cloudnative-br<br>#gitops-br<br>#cicd-br<br>#coberturas-br (coberturas de eventos)<br>#devopsdays-br<br>#codigo-de-conduta (canal de voluntários e mantenedores)<br><br><strong>Os canais de tecnologias diversas:</strong><br><br>#packer-br<br>#terraform-br<br>#docker-br<br>#gitlab-br<br>#ansible-br<br><br><strong>As comunidades de TI variadas:</strong><br><br>#macusers-br<br>#tecladomecanico</p>
<p><strong>Canais comuns apenas no Matrix.org e Discord #BolhaTech</strong><br><br>#kubernetes-br<br>#rancher-br<br>#servicemesh-br<br><br>#vault-br<br>#nomad-br<br>#boundary-br<br><br>#eventos-br<br>#vagas-br<br><br><strong>Canais presentes – no momento – apenas no Discord #BolhaTech<br><br></strong>#cloud-aws<br>#cloud-gcp<br>#cloud-oracle<br>#cloud-azure<br><br>#sgbd-mysql<br>#sgbd-postgresql<br>#sgbd-redis<br><br>#network-br<br>#linux-br<br><br><strong>Redes Cobertas pela bridge</strong><br><br>- Telegram<br>- Matrix.org<br>- Discord, servidor #BolhaTech (<a href="https://abre.ai/bolhatech">https://abre.ai/bolhatech</a>)<br><br><strong>Tecnologia de Bridge</strong></p>
<p>- Matterbridge<br><br>Que integrar seu canal? Me chama no Matrix ou Discord que eu te ajudo.<br><br>[s]<br>Guto</p>
<p>---<br><br>Este post é do tipo #FalaGutera, entenda <a href="https://gutocarvalho.net/sobre-o-que-e-a-tag-falagutera/">aqui</a>.</p>
<p>Se gostou manda um alo no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a>.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Novo discord #BolhaTech</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/novo-discord-server-bolhatech/"/>
        <id>https://gutocarvalho.net/novo-discord-server-bolhatech/</id>
            <category term="FalaGutera"/>

        <updated>2022-04-14T16:08:09-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Criamos um DISCORD para dominar o mundo... Brincadeira :P</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Criamos um DISCORD para dominar o mundo... Brincadeira :P</p>

<p>Fala meu povo.</p>
<p>Passando para avisar que criamos um servidor no DISCORD chamado <strong>#BolhaTech</strong> e estamos integrando os canais dele com os canais do <strong>TELEGRAM</strong> e <strong>MATRIX.ORG</strong>.<br><br>Os mesmos canais de TI em 3 redes diferentes, use a rede que quiser.<br><br>Veja <a href="https://gutocarvalho.net/canais-de-ti-integrados-em-3-redes/" target="_blank" rel="noopener noreferrer">aqui</a> a lista de canais integrados e disponíveis.</p>
<p>:)</p>
<p>Só vem!</p>
<p>- <a>https://abre.ai/bolhatech</a></p>
<p>[s]<br>Guto<br><br>---<br><br>Este post é do tipo #FalaGutera, entenda <a href="https://gutocarvalho.net/sobre-o-que-e-a-tag-falagutera/">aqui</a>.</p>
<p>Se gostou manda um alo no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a>.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Sem telegram? Vem pro Matrix!</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/sem-telegram-entao-vem-pro-matrix/"/>
        <id>https://gutocarvalho.net/sem-telegram-entao-vem-pro-matrix/</id>
            <category term="FalaGutera"/>

        <updated>2022-03-21T19:10:05-03:00</updated>
            <summary>
                <![CDATA[
                    <p>O ministro do STF Alexandre de Moraes determinou o <a href="https://www1.folha.uol.com.br/poder/2022/03/alexandre-de-moraes-determina-bloqueio-do-telegram-em-todo-o-brasil.shtml">bloqueio</a> do <strong>Telegram</strong> em todo Brasil.</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>O ministro do STF Alexandre de Moraes determinou o <a href="https://www1.folha.uol.com.br/poder/2022/03/alexandre-de-moraes-determina-bloqueio-do-telegram-em-todo-o-brasil.shtml">bloqueio</a> do <strong>Telegram</strong> em todo Brasil.</p>

<p>Obviamente isso não é algo imediato, as operadoras <strong>pediram até terça-feira</strong> para fazer tal bloqueio.</p>
<p>No momento tem muita gente migrando para outras redes e a maioria está com receio de ficar sem acesso a suas comunidades de TI no Telegram.</p>
<p>Em fevereiro eu escrevi um post sobre isso, no qual eu disse que eu já imaginava esse possível cenário, portanto, eu comecei a criar "<strong>bridges</strong>" entre os canais que eu mantenho no <strong>telegram</strong> e a rede "<strong>matrix.org</strong>".</p>
<p>Eu explico o processo todo nesse post aqui<br><br>- <a href="https://gutocarvalho.net/migrando-telegram-para-matrix/">https://gutocarvalho.net/migrando-telegram-para-matrix/</a></p>
<p>Leia o post para entender porque eu recomendo a matrix.org e como usar essa rede no celular, web ou desktop.<br><br>Canais que você vai encontrar lá conectados ao telegram</p>
<p>#cicd-br (canal #cdnbr no telegram)<br>#gitops-br<br>#cloudnative-br<br>#macusers-br<br>#tecladomecanico<br>#gitlab-br<br>#docker-br<br>#packer-br<br>#devops-br<br>#terraform-br<br>#devopsdays-br<br>#coberturas-br<br>#ansible-br<br>#codigo-de-conduta<br><br>Outros canais só no Matrix<br><br>#kubernetes-br<br>#rancher-br<br><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);"><br>Se você mantém comunidades no </span><strong style="font-family: var(--editor-font-family); font-size: inherit;">Telegram</strong><span style="color: var(--text-primary-color); font-family: var(--editor-font-family); font-size: inherit; font-weight: var(--font-weight-normal);"> e precisa de ajuda para criar uma bridge para alguma outra rede, me chama no twitter (@gutocarvalho) que eu tento de ajudar da melhor forma :)</span></p>
<p>[s]<br>Guto<br><br></p>
<p>---<br><br>Este post é do tipo #FalaGutera, entenda <a href="https://gutocarvalho.net/sobre-o-que-e-a-tag-falagutera/">aqui</a>.</p>
<p>Se gostou manda um alo no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a>.</p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>DIG Crash Course</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/dig-crash-course/"/>
        <id>https://gutocarvalho.net/dig-crash-course/</id>
            <category term="crash-course"/>
            <category term="MindNotes"/>

        <updated>2022-03-14T10:02:20-03:00</updated>
            <summary>
                <![CDATA[
                    DIG Crash Course O DIG é uma ferramenta para interrogar servidores de&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <h1 id="dig-crash-course">DIG Crash Course</h1>
<p>O DIG é uma ferramenta para interrogar servidores de DNS.</p>
<p>Com o DIG nós conseguiremos fazer lookup de DNS com objetivos simples como troubleshooting por exemplo.</p>
<p>A ideia aqui é fazer um crash course dessa ferramenta. </p>
<p>Um Crash Course é um tipo de “curso rápido” sobre um determinado assunto, indo direto ao ponto de forma mais objetiva possível.</p>
<h2 id="quando-devo-usar-o-dig">Quando devo usar o DIG?</h2>
<p>Sempre que você precisar verificar alguma coisa em nível de DNS, seguem alguns cenários que o DIG pode te ajudar :</p>
<ul>
<li>para testar se a resolução de DNS está funcionando</li>
<li>para comparar a resolução de DNS entre NS diferentes</li>
<li>quando precisamos resolver um problema de DNS</li>
<li>para descobrir o IP de um registro de DNS</li>
<li>para descobrir o MX de um domínio</li>
<li>para descobrir o NS de um domínio</li>
<li>para descobrir o SOA de um domínio</li>
<li>para descobrir o PTR (reverso) de um endereço IP</li>
<li>para verificar se uma alteração de registro já fez efeito</li>
</ul>
<p>Essas são algumas das situações mais básicas em que o DIG pode ser útil.</p>
<h2 id="para-quem-foi-feito-esse-post">Para quem foi feito esse post?</h2>
<p>Aqui o foco está nas pessoas atuando nas posições abaixo:</p>
<ul>
<li>Sysadmin;</li>
<li>Cloud Native Engineer;</li>
<li>Cloud Engineer;</li>
<li>DevOps Engineer;</li>
<li>Plataform Engineer;</li>
<li>GitOps Engineer.</li>
</ul>
<h2 id="momento-merchan-p">Momento Merchan :P</h2>
<p>Me siga no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a> e acompanhe meus posts sobre Cloud Native e CI/CD.</p>
<p>Aproveite e siga a <a href="https://twitter.com/CDeliveryFdn">CD Foundation</a> e <a href="https://twitter.com/cloudnativefdn">Cloud Native Foundation</a> no twitter.</p>
<h2 id="colaboradores">Colaboradores</h2>
<p>Pessoas que colaboraram com o texto.</p>
<ul>
<li>Julia Lamenza (@jlamenza)</li>
<li>João (@P0ssuidao)</li>
<li>Rafael Gomex (@gomex)</li>
<li>Rafael Silva (@rafaotetra)</li>
</ul>
<h2 id="dig-crash-course-1">Dig Crash Course</h2>
<h3 id="aprendendo-o-básico-para-uso-no-dia-a-dia">Aprendendo o básico para uso no dia a dia</h3>
<h4 id="fazendo-uma-pesquisa-simples-com-todos-os-detalhes">fazendo uma pesquisa simples com todos os detalhes</h4>
<pre><code>$ dig gutocarvalho.net
</code></pre>
<h4 id="fazendo-uma-pesquisa-simples-retornando-só-o-ip">fazendo uma pesquisa simples retornando só o IP</h4>
<pre><code>$ dig +short gutocarvalho.net
</code></pre>
<h4 id="pesquisando-o-soa-do-domínio">pesquisando o SOA do domínio</h4>
<pre><code>$ dig SOA gutocarvalho.net
</code></pre>
<h4 id="pesquisando-o-ns-do-domínio">pesquisando o NS do domínio</h4>
<pre><code>$ dig NS gutocarvalho.net 
</code></pre>
<h4 id="pesquisando-o-mx-de-correio">pesquisando o MX de correio</h4>
<pre><code>$ dig MX gutocarvalho.nmet
</code></pre>
<h4 id="pesquisando-o-ttl-do-domínio">pesquisando o TTL do domínio</h4>
<pre><code>$ dig TTL gutocarvalho.net
</code></pre>
<h4 id="pesquisando-o-ptr-reverso-de-um-ip">pesquisando o PTR (reverso) de um IP</h4>
<pre><code>$ dig -x 8.8.8.8
</code></pre>
<h4 id="pesquisando-os-registros-txt-de-um-domínio">pesquisando os registros TXT de um domínio</h4>
<pre><code>$ dig txt gutocarvalho.net
</code></pre>
<h3 id="explorando-um-pouco-mais-o-dig">Explorando um pouco mais o DIG</h3>
<h4 id="pesquisando-um-registro-em-um-ns-específico">pesquisando um registro em um NS específico</h4>
<pre><code>$ dig @1.1.1.1 lb.gutocarvalho
</code></pre>
<h4 id="pesquisando-as-informações-dnssec-de-um-domínio">pesquisando as informações DNSSEC de um domínio</h4>
<pre><code>$ dig +dnssec gutocarvalho.net
</code></pre>
<h3 id="pesquisando-as-chaves-dnssec-de-um-domínio">pesquisando as chaves DNSSEC de um domínio</h3>
<pre><code>$ dig DNSKEY -qr gutocarvalho.net
</code></pre>
<h4 id="pesquisando-uma-entrada-de-dns-com-trace">pesquisando uma entrada de DNS com trace</h4>
<pre><code>$ dig +trace lb.gutocarvalho.net
</code></pre>
<h4 id="verificando-o-tempo-de-resposta-do-soa-de-um-domínio">verificando o tempo de resposta do SOA de um domínio</h4>
<pre><code>$ dig +nssearch gutocarvalho.net
</code></pre>
<h3 id="parâmetros-interessantes-do-dig">Parâmetros interessantes do DIG</h3>
<h4 id="short">+short</h4>
<pre><code>$ dig gutocarvalho.net +short

185.199.110.153
185.199.111.153
185.199.108.153
185.199.109.153
</code></pre>
<p>O short só retorna os IPs para qual o registro aponta.</p>
<h4 id="tcp">+tcp</h4>
<pre><code>$ dig +tcp gutocarvalho.net
</code></pre>
<p>Usado quando desejamos fazer a pesquisa via TCP, o padrão é UDP.</p>
<h4 id="time">+time</h4>
<pre><code>$ dig +time=5 gutocarvalho.net
</code></pre>
<p>Define o timeout da pesquisa para 5 segundos.</p>
<h4 id="multiline">+multiline</h4>
<pre><code>$ dig gutocarvalho.net A +dnssec +multiline
</code></pre>
<p>Vai pesquisar entradas A com DNSSEC associado em multi-linhas.</p>
<h3 id="filtrando-saída-do-dig-com-parâmetros-especiais">Filtrando saída do DIG com parâmetros especiais</h3>
<p>Primeiro vamos fazer uma pesquisa comum para ter uma saída completa</p>
<pre><code>$ dig gutocarvalho.net

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 40038
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;gutocarvalho.net.        IN    A

;; ANSWER SECTION:
gutocarvalho.net.    300    IN    A    185.199.108.153
gutocarvalho.net.    300    IN    A    185.199.109.153
gutocarvalho.net.    300    IN    A    185.199.110.153
gutocarvalho.net.    300    IN    A    185.199.111.153

;; Query time: 38 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Sat Mar 12 18:53:55 -03 2022
;; MSG SIZE  rcvd: 109
</code></pre>
<p>Agora vamos testando cada parâmetro</p>
<h4 id="noall">+noall</h4>
<pre><code>$ dig gutocarvalho.net +noall

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net +noall
;; global options: +cmd
</code></pre>
<p>Observe que o noall omite toda a saída do comando, ele normalmente é usado com outros comandos de forma composta, um exemplo é o answer.</p>
<h4 id="answer-noall">+answer +noall</h4>
<pre><code>$ dig gutocarvalho.net +noall +answer

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net +noall +answer
;; global options: +cmd
gutocarvalho.net.    300    IN    A    185.199.111.153
gutocarvalho.net.    300    IN    A    185.199.108.153
gutocarvalho.net.    300    IN    A    185.199.109.153
gutocarvalho.net.    300    IN    A    185.199.110.153
</code></pre>
<p>O answer é útil junto com o noall, ele vai nos trazer apenas a resposta, sem comments, question, authority, stats e quaisquer outras informações que estiverem disponíveis na resposta.</p>
<h4 id="nocmd">+nocmd</h4>
<pre><code> dig +nocmd a lb.gutocarvalho.net +noall +answer
lb.gutocarvalho.net.    42    IN    A    200.150.204.87
</code></pre>
<p>Quando aplicado retira a versao do bind e comando</p>
<pre><code>; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; a lb.gutocarvalho.net +noall +answer
</code></pre>
<p>Para funcionar o parâmetro tem que vir logo após o comando dig</p>
<h4 id="nocomments">+nocomments</h4>
<pre><code>$ dig gutocarvalho.net +nocomments

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net +nocomments
;; global options: +cmd
;gutocarvalho.net.        IN    A
gutocarvalho.net.    297    IN    A    185.199.110.153
gutocarvalho.net.    297    IN    A    185.199.111.153
gutocarvalho.net.    297    IN    A    185.199.108.153
gutocarvalho.net.    297    IN    A    185.199.109.153
;; Query time: 29 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Sat Mar 12 18:58:57 -03 2022
;; MSG SIZE  rcvd: 109
</code></pre>
<p>O nocomments retira toda a parte inicial da resposta</p>
<pre><code>; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 40925
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;gutocarvalho.net.        IN    A
</code></pre>
<h4 id="noquestion">+noquestion</h4>
<pre><code>$ dig gutocarvalho.net +noquestion

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net +noquestion
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 10078
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; ANSWER SECTION:
gutocarvalho.net.    300    IN    A    185.199.108.153
gutocarvalho.net.    300    IN    A    185.199.109.153
gutocarvalho.net.    300    IN    A    185.199.110.153
gutocarvalho.net.    300    IN    A    185.199.111.153

;; Query time: 42 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Sat Mar 12 19:01:58 -03 2022
;; MSG SIZE  rcvd: 109
</code></pre>
<p>O noquestion retira essa parte da resposta</p>
<pre><code>;; QUESTION SECTION:
;gutocarvalho.net.        IN    A
</code></pre>
<h4 id="nostats">+nostats</h4>
<pre><code>$ dig gutocarvalho.net +nostats

; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net +nostats
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 63625
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;gutocarvalho.net.        IN    A

;; ANSWER SECTION:
gutocarvalho.net.    300    IN    A    185.199.109.153
gutocarvalho.net.    300    IN    A    185.199.110.153
gutocarvalho.net.    300    IN    A    185.199.111.153
gutocarvalho.net.    300    IN    A    185.199.108.153
</code></pre>
<p>Esse parâmetro suprime as estatísticas da pesquisa.</p>
<pre><code>;; Query time: 38 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Sat Mar 12 19:13:28 -03 2022
;; MSG SIZE  rcvd: 109
</code></pre>
<h4 id="noauthority">+noauthority</h4>
<pre><code>;; AUTHORITY SECTION:
gutocarvalho.net.    3144    IN    NS    monroe.ns.cloudflare.com.
gutocarvalho.net.    3144    IN    NS    houston.ns.cloudflare.com.
</code></pre>
<p>É útil para remover essa parte da resposta, caso retorne o authority na pesquisa.</p>
<h4 id="noadditional">+noadditional</h4>
<pre><code>;; ADDITIONAL SECTION:
lia.ns.cloudflare.com.    84354    IN    A      173.245.58.185
lia.ns.cloudflare.com.    170762    IN    AAAA  2400:cb00:2049:1::adf5:3ab9
mark.ns.cloudflare.com.    170734    IN    A      173.245.59.130
mark.ns.cloudflare.com.    170734    IN    AAAA  2400:cb00:2049:1::adf5:3b82
</code></pre>
<p>A seção aditional pode trazer informações como o IP dos DNS Server autoritativos da seção authority, esse parâmetro suprime esse trecho.</p>
<h4 id="norec">+norec</h4>
<pre><code>$ dig +norec @monroe.ns.cloudflare.com. gutocarvalho.net a
</code></pre>
<p>Essa opção desabilita a pesquisa recursiva, neste caso a CloudFlare 
e responsável por responder por meu domínio, sendo que o servidor monroe é um dos meus servidores DNS, ele já sabe a resposta.</p>
<h2 id="pesquisas-parametrizadas-comuns">Pesquisas parametrizadas comuns</h2>
<p>pesquisa comum e rápida que retorna apenas o endereço IP</p>
<pre><code>$ dig +short lb.gutocarvalho.net
</code></pre>
<p>pesquisando por registro A com resposta simples</p>
<pre><code>$ dig +nocmd lb.gutocarvalho.net a +noall +answer
</code></pre>
<p>pesquisando por CNAME com resposta simples</p>
<pre><code>$ dig +nocmd mail.google.com cname +noall +answer
</code></pre>
<p>pesquisando por registro TXT com resposta simples</p>
<pre><code>$ dig +nocmd google.com txt +noall +answer
</code></pre>
<p>fazendo pesquisa em múltiplos domínios</p>
<pre><code>$ dig ubuntu.com mx +noall +answer redhat.com ns +noall +answer
</code></pre>
<h2 id="pesquisa-usando-um-arquivo-bulk">Pesquisa usando um arquivo (bulk)</h2>
<p>Imagine que você tem o arquivo dominios.txt com o conteúdo abaixo</p>
<pre><code>gutocarvalho.net
nativetrail.io
viahorizonte.life
</code></pre>
<p>vamos rodar agora uma pesquisa contra o arquivo</p>
<pre><code>$ dig -f dominios.txt +short
</code></pre>
<p>saída</p>
<pre><code>185.199.110.153
185.199.111.153
185.199.108.153
185.199.109.153
185.199.111.153
185.199.108.153
185.199.109.153
185.199.110.153
185.199.110.153
185.199.111.153
185.199.108.153
185.199.109.153
</code></pre>
<p>:)</p>
<h3 id="quer-saber-mais">Quer saber mais?</h3>
<p>Para saber mais veja o help do comando</p>
<pre><code>$ dig --help
</code></pre>
<p>Para ir além acesse a manpage</p>
<pre><code>$ man dig
</code></pre>
<h2 id="configurando-seu-digrc">Configurando seu .digrc</h2>
<p>O dig tem um arquivo de configuração, o famoso .digrc.</p>
<pre><code>$ echo &quot;+nostats +nocomments +nocmd +noquestion +recurse&quot; &gt; ~/.digrc
</code></pre>
<p>Agora você digita menos e tem o resultado desejado.</p>
<h2 id="um-pouco-de-teoria-de-dns-para-quem-gosta-">Um pouco de teoria de DNS para quem gosta :)</h2>
<h3 id="entendendo-o-funcionamento-do-dig">Entendendo o funcionamento do DIG</h3>
<p>Imagine que mandamos essa query pelo dig</p>
<pre><code>$ dig gutocarvalho.net
</code></pre>
<p>Essa query é estrutura da seguinte forma pelo DIG para o servidor de DNS autoritativo</p>
<pre><code>
           +-------------------------------------+
Header     | OPCODE=SQUERY                       |
           +-------------------------------------+
Question   | QNAME=GUTO.NET., QCLASS=IN, QTYPE=A |
           +-------------------------------------+
Answer     | &lt;empty&gt;                             |
           +-------------------------------------+
Authority  | &lt;empty&gt;                             |
           +-------------------------------------+
Additional | &lt;empty&gt;                             |
           +-------------------------------------+
           
</code></pre>
<p>A resposta do servidor que responde pelo domínio foi essa</p>
<pre><code>
; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; gutocarvalho.net
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 48153
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;gutocarvalho.net.        IN    A

;; ANSWER SECTION:
gutocarvalho.net.    300    IN    A    185.199.110.153
gutocarvalho.net.    300    IN    A    185.199.111.153
gutocarvalho.net.    300    IN    A    185.199.108.153
gutocarvalho.net.    300    IN    A    185.199.109.153

;; Query time: 146 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Sun Mar 13 10:37:26 -03 2022
;; MSG SIZE  rcvd: 109
</code></pre>
<p>Podemos estruturar dessa forma para entender melhor</p>
<pre><code>           +--------------------------------------------+
Header     | OPCODE=SQUERY, RESPONSE, AA                |
           +--------------------------------------------+
Question   | QNAME=GUTO.NET., QCLASS=IN, QTYPE=A        |
           +--------------------------------------------+
Answer     | GUTO.NET. 300 IN A 185.199.108.153         | 
           |                   300 IN A 185.199.109.153 |
           |                   300 IN A 185.199.110.153 |
           |                   300 IN A 185.199.111.153 |
           +--------------------------------------------+
Authority  | &lt;empty&gt;                                    |
           +--------------------------------------------+
Additional | &lt;empty&gt;                                    |
           +--------------------------------------------+
</code></pre>
<h3 id="entendendo-as-repostas-entregues-pelo-dig">Entendendo as repostas entregues pelo DIG</h3>
<p>Uma resposta de consulta do DIG vem composta por informações separadas nas seções Header, Question, Answer, Authority e Additional.</p>
<pre><code>+------------+
| Header     | Cabeçalho com informações diversas 
+------------+
| Question   | A questão enviada para o nameserver
+------------+
| Answer     | Registros que vão responder a query
+------------+
| Authority  | Registros da autoridade do domínio
+------------+
| Additional | Registros com informações adicionais
+------------+
</code></pre>
<p>Vamos entender cada uma delas.</p>
<pre><code>- Header section, um cabeçalho fixo que contém ID, flgas e informações das outras seções (contadores)

- Question section, contém a query que foi passada (QNAME), o tipo (QTYPE) e a classe (QCLLASS). Na resposta receberemos novamente a query

- Answer section, pode conter a lista de reguistros, se houver resposta cada um irá trazer QNAME, QTYPE, QCLASS, TTL e informaçÕes de RDATA

- Authority section, pode conter a lista de registros que apontam para os servidores autoritativos

- Additional section, pode conter outros registros e mais informações sobre os servidores autoritativos
</code></pre>
<h4 id="header-section">HEADER SECTION</h4>
<pre><code>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 63625
;; flags: qr rd ra ad; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1
</code></pre>
<p>Informações que encontramos do HEADER</p>
<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                      ID                       |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|QR|   Opcode  |AA|TC|RD|RA| Z|AD|CD|   RCODE   |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    QDCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    ANCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    NSCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    ARCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</code></pre>
<p>Entendendo as informações do HEADER</p>
<pre><code>QR pode conter

- 0, QUERY 
- 1, RESPONSE

OPCODE pode conter os seguintes valores:

- 0    Query    [RFC1035]
- 2    Status    [RFC1035]
- 3    Unassigned    
- 4    Notify    [RFC1996]
- 5    Update    [RFC2136]
- 6    DNS Stateful Operations (DSO)    [RFC8490]
- 7-15    Unassigned

No Header vamos encontrar as seguintes FLAGs:

- AA: Authoritative Answer (set by the server)
- TC: message is TrunCated (set by the server)
- RD: Recursion Desired (set by the client and copied to the response)
- RA: Recursion Available (set by the server)
- AD: Authenticated Data, DNSSEC flag (set by the server)
- CD: Checking Disabled, DNSSEC flag (set by the client, copied to the response)

 No Header vamos encontrar o RCODE/Status (4 bits) que pode conter:

- 0    NoError    No Error    [RFC1035]
- 1    FormErr    Format Error    [RFC1035]
- 2    ServFail    Server Failure    [RFC1035]
- 3    NXDomain    Non-Existent Domain    [RFC1035]
- 4    NotImp    Not Implemented    [RFC1035]
- 5    Refused    Query Refused    [RFC1035]
- 6    YXDomain    Name Exists when it should not    [RFC2136][RFC6672]
- 7    YXRRSet    RR Set Exists when it should not    [RFC2136]
- 8    NXRRSet    RR Set that should exist does not    [RFC2136]
- 9    NotAuth    Server Not Authoritative for zone    [RFC2136]
- 9    NotAuth    Not Authorized    [RFC8945]
- 10    NotZone    Name not contained in zone    [RFC2136]
- 11    DSOTYPENI    DSO-TYPE Not Implemented    [RFC8490]
- 12-15    Unassigned        
- 16    BADVERS    Bad OPT Version    [RFC6891]
- 16    BADSIG    TSIG Signature Failure    [RFC8945]
- 17    BADKEY    Key not recognized    [RFC8945]
- 18    BADTIME    Signature out of time window    [RFC8945]
- 19    BADMODE    Bad TKEY Mode    [RFC2930]
- 20    BADNAME    Duplicate key name    [RFC2930]
- 21    BADALG    Algorithm not supported    [RFC2930]
- 22    BADTRUNC    Bad Truncation    [RFC8945]
- 23    BADCOOKIE    Bad/missing Server Cookie    [RFC7873]
- 24-3840    Unassigned        
- 3841-4095    Reserved for Private Use        [RFC6895]
- 4096-65534    Unassigned        
- 65535    Reserved, can be allocated by Standards Action        [RFC6895]

No Header também temos contadores, são eles:

- QDCOUNT, número de respostas da seção queries
- ANCOUNT, número de respostas da seção answers
- NSCOUNT, número de respostas da seção autoritativos
- ARCOUNT, número de respostas da seção adicional

Os contadores vão retornar o número de registros encontrados na pesquisa
</code></pre>
<p>Entendendo um pouco mais das Flags do HEADER</p>
<pre><code>Você verá que na resposta teremos geralmente 4 flags setadas, sao elas:

- qr, rd, ra, ad.

Vamos entendê-las agora

- QR, é uma flag diferente que pode retornar 0 ou 1, 1 significa query

- RD significa &quot;recursive desired&quot;, sinaliza que desejamos usar pesquisa recursiva, isso é definido pelo cliente.

- RA significa &quot;recursive available&quot;, sinaliza que pesquisa recursiva está disponível, isso é definiado pelo servidor.

- AD significa &quot;authenticated data&quot;, sinaliza que os dados de resposta e autoridade foram validados e autenticados pelas políticas de segurança daquele servidor de dns. É setado apenas quando todos os dados da resposta foram devidamente criptografados e verificados. Esse é um recurso do DNSSEC.

Existem ainda as seguintes flags opcionais

- AA, significa servidor autoritativo

- TC, significa mensagem truncada

E no caso de DNSSEC pode conter ainda

- CD, significa &quot;checking disabled&quot;, utilizado pelo DNSSEC.

- DO, que significa que a resposta do DNSSEC está ok
</code></pre>
<p>Entendendo os status (RCODE) mais comuns </p>
<pre><code>- NOERROR (0), a pesquisa voltou sem erros
- SERVFAIL (2), houve uma falha na resposta do servidor
- NXDOMAN (3), o domínio não foi encontrado ou não existe
- REFUSED (5), o pedido de query foi recusado
</code></pre>
<h4 id="question-section">QUESTION SECTION</h4>
<p>Aqui encontraremos dados de nossa query.</p>
<pre><code>;; QUESTION SECTION:
;gutocarvalho.net.        IN    A
</code></pre>
<p>Uma query é estruturada da seguinte forma:</p>
<pre><code>    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                     QNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QTYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QCLASS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</code></pre>
<p>Vamos entender QNAME, QTYPE e QCLASS.</p>
<pre><code>
- QNAME possuirá o domínio que você setou na query
- QTYPE possuirá o tipo de RR que você utilizou na pesquisa
- QCLASS possuirá o tipo de classe de DNS, geralmente IN (internet)
</code></pre>
<h4 id="answer-section">ANSWER SECTION</h4>
<pre><code>;; ANSWER SECTION:
gutocarvalho.net.    300    IN    A    185.199.108.153
gutocarvalho.net.    300    IN    A    185.199.109.153
gutocarvalho.net.    300    IN    A    185.199.110.153
gutocarvalho.net.    300    IN    A    185.199.111.153
</code></pre>
<p>Retorna os registros e informações destes, se houver.</p>
<h4 id="authority-section">AUTHORITY SECTION</h4>
<pre><code>;; AUTHORITY SECTION:
gutocarvalho.net.    3533    IN    NS    monroe.ns.cloudflare.com.
gutocarvalho.net.    3533    IN    NS    houston.ns.cloudflare.com.
</code></pre>
<p>Retorna dados de autoridade acerca do domínio.</p>
<h4 id="aditional-section">ADITIONAL SECTION</h4>
<pre><code>;; ADDITIONAL SECTION:
monroe.ns.cloudflare.com. 107    IN    A    172.64.34.153
houston.ns.cloudflare.com. 900    IN    A    172.64.35.52
</code></pre>
<p>Retorna dados adicionais da query.</p>
<h4 id="query-section">QUERY SECTION</h4>
<pre><code>;; Query time: 36 msec
;; SERVER: 1.1.1.1#53(1.1.1.1)
;; WHEN: Sat Mar 12 19:49:29 -03 2022
;; MSG SIZE  rcvd: 109
</code></pre>
<p>Retorna métricas da query, auto explicativo.</p>
<h3 id="glossário">Glossário</h3>
<p>termos comuns</p>
<ul>
<li>Zona, Uma zona contém as informações e registros de um domínio</li>
<li>TTL, significa Time to live, é o tempo de vida de um registro ou zona</li>
<li>DNSSEC, é um sistema de proteção que aumenta a segurança do DNS</li>
</ul>
<p>tipos de registros comuns e seus significados</p>
<ul>
<li>SOA, Start of Authority ou início de autoridade</li>
<li>NS, significa nameserver, esse registro aponta para um servidor de DNS</li>
<li>A, registro tipo endereço ipv4, é associado a um endereço IP</li>
<li>AAAA, registro tipo endereço ipv6, é associado a um endereço IP</li>
<li>PTR, registro tipo reverso, ele resolve um IP para um nome</li>
<li>CNAME, nome canônico, ele resolve um nome para outro nome.</li>
<li>MX, significa mail exchange, aponta para o servidor de correio</li>
<li>TXT, registros de texto, podem ter qualquer tipo de informação</li>
</ul>
<p>tipos de registro para DNSSEC</p>
<ul>
<li>DNSKEY: keeps the public key to verify RRSIGs</li>
<li>DS: keeps the digest of a DNSKEY RR</li>
<li>RRSIG: keeps the digital signature of an RRset</li>
<li>NSEC: used for authenticated denial existence, meaning to show an RRset is not part of a signed zone</li>
</ul>
<p>tipos de pesquisa de DNS</p>
<ul>
<li>Iterative approach: where the resolver/client repeatedly queries different servers until it finds the answer</li>
<li>Recursive approach: where the resolver/client sends the query only to a single server, but the server repeatedly queries different servers until it finds and returns the answer to the resolver</li>
</ul>
<h2 id="quais-outras-ferramentas-uso-para-troubleshooting-de-dns">Quais outras ferramentas uso para troubleshooting de DNS?</h2>
<p>ferramentas clássicas</p>
<ul>
<li>nslookup</li>
<li>host</li>
<li>whois</li>
</ul>
<p>ferramentas extras para testes do lado do cliente</p>
<ul>
<li><a href="https://github.com/projectdiscovery/dnsprobe">dnsprobe</a></li>
<li><a href="https://www.mavetju.org/unix/dnstracer.php">dnstracer</a></li>
<li><a href="//github.com/projectdiscovery/subfinder">subfinder</a> (para encontrar subdomains)</li>
<li><a href="https://github.com/dnsviz/dnsviz/">dnsviz</a> (avalia comportamento do seu DNS Server/DNSSEC)</li>
</ul>
<p>ferramentas extras para testes em seu servidor de dns</p>
<ul>
<li><a href="http://dns.measurement-factory.com/tools/dnstop/index.html">dnstop</a> (métricas)</li>
<li><a href="https://github.com/DNS-OARC/dnsperf">dnsperf</a> (teste de carga)</li>
<li><a href="https://github.com/DNS-OARC/flamethrower">flamethrower</a> (teste de carga)</li>
<li><a href="https://github.com/sandeeprenjith/dnsblast">dnsblast</a> (teste de carga)</li>
</ul>
<h2 id="quais-os-comandos-que-eu-mais-uso-no-dia-a-dia">Quais os comandos que eu mais uso no dia-a-dia?</h2>
<pre><code>$ dig +short lb.gutocarvalho.net
$ dig -x 200.150.204.87
$ dig mx gutocarvalho.net
$ dig ns gutocarvalho.net
</code></pre>
<h2 id="amarrando-as-pontas">Amarrando as pontas</h2>
<p>Esse post é uma tentativa de dar um norte ou um caminho para fazer um bom troubleshooting de DNS.</p>
<p>Volte aqui sempre que precisar :)</p>
<h2 id="aquele-abraço">Aquele abraço!</h2>
<p>Mando aquele abraço para o professor MESTRE Ulysses Almeida (@ulyssesalmeida) que me ensinou a usar o DIG lá no início do século.</p>
<p>Mando aquele abraço pro @gomex e @badtux que via exemplo me fazem contribuir mais e mais e mais :)</p>
<p>Mando aquele abraço para todos que leram, comentaram, revisaram e contribuíram de alguma forma com esse post!</p>
<h3 id="dns-rfcs">DNS RFC’s</h3>
<ul>
<li><a href="https://www.ietf.org/rfc/rfc1034.txt">https://www.ietf.org/rfc/rfc1034.txt</a></li>
<li><a href="https://www.ietf.org/rfc/rfc1035.txt">https://www.ietf.org/rfc/rfc1035.txt</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://linux.die.net/man/1/dig">https://linux.die.net/man/1/dig</a></li>
<li><a href="https://cmdref.net/os/linux/command/dig.html">https://cmdref.net/os/linux/command/dig.html</a></li>
<li><a href="https://ipok.com.br/blog/usando-dig-para-pesquisas-de-dns-parte-1">https://ipok.com.br/blog/usando-dig-para-pesquisas-de-dns-parte-1</a></li>
<li><a href="https://ipok.com.br/blog/usando-dig-para-pesquisas-de-dns-parte-2">https://ipok.com.br/blog/usando-dig-para-pesquisas-de-dns-parte-2</a></li>
<li><a href="https://linuxize.com/post/how-to-use-dig-command-to-query-dns-in-linux">https://linuxize.com/post/how-to-use-dig-command-to-query-dns-in-linux</a></li>
<li><a href="https://www.hostinger.com/tutorials/how-to-use-the-dig-command-in-linux">https://www.hostinger.com/tutorials/how-to-use-the-dig-command-in-linux</a></li>
<li><a href="https://metebalci.com/blog/a-short-practical-tutorial-of-dig-dns-and-dnssec">https://metebalci.com/blog/a-short-practical-tutorial-of-dig-dns-and-dnssec</a></li>
<li><a href="https://neverendingsecurity.wordpress.com/2015/04/13/dig-commands-cheatsheet">https://neverendingsecurity.wordpress.com/2015/04/13/dig-commands-cheatsheet</a></li>
</ul>
<hr>
<p>Este post é do tipo #Mindnodes, entenda <a href="https://gutocarvalho.net/o-que-sao-mindnotes/">aqui</a>.</p>
<p>Se gostou manda um alô no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a> ou deixa um comentário bacana :)</p>
<p>[s]<br>
Guto</p>

            ]]>
        </content>
    </entry>
    <entry>
        <title>TCPDUMP Crash Course</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/tcpdump-crash-course/"/>
        <id>https://gutocarvalho.net/tcpdump-crash-course/</id>
            <category term="crash-course"/>
            <category term="MindNotes"/>

        <updated>2022-03-12T22:36:50-03:00</updated>
            <summary>
                <![CDATA[
                    O TCPDUMP é uma ferramenta de captura e análise de pacotes usada&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>O TCPDUMP é uma ferramenta de captura e análise de pacotes usada para fazer troubleshooting de rede. Ele usa a LIBCAP para fazer isso.</p>
<p>A ideia aqui é fazer um crash course dessa ferramenta. </p>
<p>Um Crash Course é um tipo de “curso rápido” sobre um determinado assunto, indo direto ao ponto de forma mais objetiva possível.</p>
<h2 id="quando-devo-usar-o-tcpdump">Quando devo usar o tcpdump?</h2>
<p>Sempre que você precisar verificar alguma coisa em nível de rede, seguem algumas perguntas que o TCPDUMP pode ajudar a responder:</p>
<ul>
<li>A máquina X está chega no servidor Y ?</li>
<li>A máquina X está conseguindo resolver DNS ?</li>
<li>A máquina X está conseguindo resolver NTP ?</li>
<li>Os clientes estã chegando na Máquina X e porta Y ?</li>
</ul>
<p>Essa são as perguntas mais básicas que o TCPDUMP pode responder para você.</p>
<h2 id="para-quem-foi-feito-esse-post">Para quem foi feito esse post?</h2>
<p>Aqui o foco está nas pessoas atuando nas posições abaixo:</p>
<ul>
<li>Sysadmin;</li>
<li>Cloud Native Engineer;</li>
<li>Cloud Engineer;</li>
<li>DevOps Engineer;</li>
<li>Plataform Engineer;</li>
<li>GitOps Engineer.</li>
</ul>
<h2 id="momento-merchan-p">Momento Merchan :P</h2>
<p>Me siga no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a> e acompanhe meus posts sobre Cloud Native e CI/CD.</p>
<p>Aproveite e siga a <a href="https://twitter.com/CDeliveryFdn">CD Foundation</a> e <a href="https://twitter.com/cloudnativefdn">Cloud Native Foundation</a> no twitter.</p>
<h2 id="colaboradores">Colaboradores</h2>
<p>Pessoas que colaboraram com o texto.</p>
<ul>
<li>Julia Lamenza (@jlamenza)</li>
<li>João (@P0ssuidao)</li>
<li>Rafael Gomex (@gomex)</li>
<li>Rafael Silva (@rafaotetra)</li>
</ul>
<h2 id="tcpdump-crash-course">TCPDUMP Crash Course</h2>
<h3 id="instalando-no-mac">instalando no mac</h3>
<pre><code>$ brew install tcpdump
</code></pre>
<h3 id="detectando-recursos-disponíveis-no-sistema">detectando recursos disponíveis no sistema</h3>
<p>Listando interfaces</p>
<pre><code>$ tcpdump -D
</code></pre>
<p>Listando data-link types suportados no sistema</p>
<pre><code>$ tcpdump -L
</code></pre>
<h3 id="capturando-pacotes-de-interfaces">capturando pacotes de interfaces</h3>
<p>Capturando tráfego de todas as interfaces</p>
<pre><code>$ tcpdump -i any
</code></pre>
<p>Capturando tráfego de uma interface específica</p>
<pre><code>$ tcpdump -i en0
</code></pre>
<p>Capturando tráfego de uma interface específica sem resolver nomes</p>
<pre><code>$ tcpdump -n -i en0
</code></pre>
<p>Capturando tráfego de uma interface específica sem resolver nomes ou fazer checksums TCP</p>
<pre><code>$ tcpdump -n -K -i en0
</code></pre>
<p>Capturando tráfego de uma interface específica sem resolver nomes e fazer lookups</p>
<pre><code>$ tcpdump -nn -i en0
</code></pre>
<p>Capturando tráfego de uma interface específica mostrando o mac address</p>
<pre><code>$ tcpdump -e -i en0
</code></pre>
<p>Capturando tráfego de uma interface específica sem ativar o modo promíscuo, ou seja você apenas verá pacotes PARA ou DE seu computador.</p>
<pre><code>$ tcpdump -p -i en0
</code></pre>
<h3 id="trabalhando-com-arquivos">trabalhando com arquivos</h3>
<p>Capturando tráfego de uma interface específica e jogando saída para um arquivo</p>
<pre><code>$ tcpdump -i eth0 -w tcpdump.txt
</code></pre>
<p>Limitando a captura em 10.000 pacotes para não encher seu disco</p>
<pre><code>$ tcpdump -i eth0 -c 10000 -w tcpdump.txt
</code></pre>
<p>Lendo pacotes de um arquivo (replay)</p>
<pre><code>$ tcpdump -i eth0 -r tcpdump.txt
</code></pre>
<h3 id="capturando-pacotes-de-hosts-e-redes-específicos">capturando pacotes de hosts e redes específicos</h3>
<p>Capturando tráfego de um host específico</p>
<pre><code>$ tcpdump host 192.168.222.1
</code></pre>
<p>Capturando tráfego de uma rede específica</p>
<pre><code>$ tcpdump net 192.168.222.0/24
</code></pre>
<h3 id="capturando-pacotes-de-endereços-mac-específicos">capturando pacotes de endereços mac específicos</h3>
<p>Capturando pacotes com origem no endereço mac e8:2b:88:ef:55:11</p>
<pre><code>$ tcpdump ether src e8:2b:88:ef:55:11
</code></pre>
<p>Capturando pacotes com destino ao endereço mac e8:2b:88:ef:55:11</p>
<pre><code>$ tcpdump ether dst e8:2b:88:ef:55:11
</code></pre>
<p>Capturando pacotes enviados ou recebidos pelo mac e8:2b:88:ef:55:11</p>
<pre><code>$ tcpdump ether host e8:2b:88:ef:55:11
</code></pre>
<h3 id="capturando-pacotes-de-origem-e-destino">capturando pacotes de origem e destino</h3>
<p>Capturando tráfego de uma origem específica</p>
<pre><code>$ tcpdump src 200.150.204.87
</code></pre>
<p>Capturando tráfego para um destino específico</p>
<pre><code>$ tcpdump dst 200.150.204.87
</code></pre>
<h3 id="capturando-pacotes-de-serviços-e-portas">capturando pacotes de serviços e portas</h3>
<p> Capturando tráfego de um serviço específico</p>
<pre><code>$ tcpdump http
</code></pre>
<p>Capturando tráfego de uma porta específica</p>
<pre><code>$ tcpdump port 80
</code></pre>
<p>Capturando tráfego de um range de portas   </p>
<pre><code>$ tcpdump portrange 8001-8009
    
</code></pre>
<h3 id="capturando-pacotes-de-protocolos-específicos">capturando pacotes de protocolos específicos</h3>
<p>Capturando apenas pacotes IPv4</p>
<pre><code>$ tcpdump ip
</code></pre>
<p>Capturando apenas pacotes IPv6</p>
<pre><code>$ tcpdump ipv6
</code></pre>
<p>Capturando apenas pacotes TCP</p>
<pre><code>$ tcpdump tcp
</code></pre>
<p>Capturando apenas pacotes UDP</p>
<pre><code>$ tcpdump udp
</code></pre>
<p>Capturando apenas pacotes ICMP</p>
<pre><code>$ tcpdump icmp
</code></pre>
<p>Capturando apenas pacotes ARP</p>
<pre><code>$ tcpdump arp
</code></pre>
<h3 id="capturando-pacotes-em-quantidades-específicas">capturando pacotes em quantidades específicas</h3>
<p>Capturando os primeiros 100 pacotes TCP</p>
<pre><code>$ tcpdump -c 100 tcp
</code></pre>
<h3 id="capturando-pacotes-de-tamanhos-específicos">capturando pacotes de tamanhos específicos</h3>
<p>Capturando pacotes maiores do que 200 bytes</p>
<pre><code>$ sudo tcpdump greater 200
</code></pre>
<p>Capturando pacotes menores do que 200 bytes</p>
<pre><code>$ sudo tcpdump less 200
</code></pre>
<h3 id="capturando-pacotes-usando-expressões-lógicas-no-filtro">capturando pacotes usando expressões lógicas no filtro</h3>
<p>Capturando pacotes com origem no IP 192.168.222.1 <strong>e</strong> destino na porta 8005 (AND)</p>
<pre><code>$ tcpdump -n -i en0 src 192.168.222.1 and dst port 8005
</code></pre>
<p>Capturando pacotes da porta 8001 <strong>ou</strong> 8005 da interface eth0 (OR)</p>
<pre><code>$ tcpdump -n -i en0 port 8001 or port 8005
</code></pre>
<p>Capturando pacotes da interface eth0 <strong>com exceção</strong> da porta 22 (NOT)</p>
<pre><code>$ tcpdump -n -i en0 not port 22
</code></pre>
<p>Capturando pacotes de origem a rede 10.10.0.0/24 e destino rede 192.169.100.0/24 (AND)</p>
<pre><code>$ tcpdump src net 10.10.0.0/24 and dst net 192.168.100.0/24
</code></pre>
<p>Capturando pacotes de duas redes específicas (AND)</p>
<pre><code>$ tcpdump net 10.10.0.0/24 and net 192.168.100.0/24
</code></pre>
<p>Capturando pacotes tcp entre dois hosts específicos (AND)</p>
<pre><code>$ tcpdump tcp and host 10.10.0.1 and host 192.168.100.54
</code></pre>
<p>Capturando pacotes maiores ou igual a 32 bytes (GREATER)</p>
<pre><code>$ tcpdump tcp &gt;= 32
</code></pre>
<p>Capturando pacotes menores ou igual a 32 bytes (LESS)</p>
<pre><code>$ tcpdump tcp &lt;= 32
</code></pre>
<h4 id="quais-as-expressões-lógicas-disponíveis">quais as expressões lógicas disponíveis?</h4>
<pre><code>Negation    : ! or &quot;not&quot; (without the quotes)
Concatanate : &amp;&amp; or &quot;and&quot;
Alternate   : || or &quot;or&quot;
</code></pre>
<h4 id="quais-os-operadores-disponíveis">quais os operadores disponíveis?</h4>
<pre><code>&gt;  : greater
&lt;  : lower
&gt;= : greater or equal
&lt;= : lower or equal
=  : equal
!= : different
</code></pre>
<h4 id="veja-alguns-exemplos-de-composição-lógica-múltipla">veja alguns exemplos de composição lógica múltipla</h4>
<p>Essa regra vai casar com tráfego na porta 80 com host 192.168.222.254 ou 192.168.222.200</p>
<pre><code>$ tcpdump &#39;((tcp) and (port 80) and ((dst host 192.168.222.254) or (dst host 192.168.222.200)))&#39;
</code></pre>
<p>Essa regra vai casar com qualquer tráfego ICMP envolvendo os destinos 00:01:02:03:04:05.</p>
<pre><code>$ tcpdump &#39;((icmp) and ((ether dst host 00:01:02:03:04:05)))&#39;
</code></pre>
<p>Essa regra vai filtrar tráfego para a rede de destino 192.168 com exceção do host 192.168.222.200</p>
<pre><code>$ tcpdump &#39;((tcp) and ((dst net 192.168) and (not dst host 192.168.222.200)))&#39;
</code></pre>
<h3 id="capturando-flags-de-pacotes-tcp">capturando flags de pacotes TCP</h3>
<p>Isolando apenas flags RST do protocolo TCP</p>
<pre><code>$ tcpdump &#39;tcp[tcpflags] == tcp-rst&#39;
</code></pre>
<p>Isolando apenas flags SYN e ACK do protocolo TCP</p>
<pre><code>$ tcpdump &#39;tcp[tcpflags] == tcp-syn&#39; and &#39;tcp[tcpflags] == tcp-ack&#39;
</code></pre>
<p>Isolando apenas flags FIN do protocolo TCP</p>
<pre><code>$ tcpdump &#39;tcp[tcpflags] == tcp-fin&#39;
</code></pre>
<h3 id="capturando-informações-do-protocolo-http">capturando informações do protocolo HTTP</h3>
<p>Essa captura vai mostrar os requests e conteúdos dos pacotes HTTP</p>
<pre><code>$tcpdump -A -i en0 http
</code></pre>
<p>Capturando o user agent</p>
<pre><code>$ tcpdump -vvAls0 | grep &#39;User-Agent:&#39;
</code></pre>
<p>Capturando requisições do tipo GET</p>
<pre><code>$ tcpdump -vvAls0 | grep &#39;GET&#39;
</code></pre>
<p>Capturando requisições do tipo POST</p>
<pre><code>$ tcpdump -vvAls0 | grep &#39;POST&#39;
</code></pre>
<p>Capturando HTTP HEADERS</p>
<pre><code>$ tcpdump -vvAls0 | grep &#39;Host:&#39;
</code></pre>
<p>Capturando HTTP COOKIES</p>
<pre><code>$ tcpdump -vvAls0 | grep &#39;Set-Cookie|Host:|Cookie:&#39;
</code></pre>
<h3 id="capturando-infos-específicas-de-protocolos-diversos">capturando infos específicas de protocolos diversos</h3>
<p>Buscando tráfego SSH independente da porta que estiver rodando</p>
<pre><code>$ tcpdump &#39;tcp[(tcp[12]&gt;&gt;2):4] = 0x5353482D&#39;
</code></pre>
<p>Buscando tráfego de DNS</p>
<pre><code>$ tcpdump -vvAs0 port 53
</code></pre>
<p>Buscando tráfego NTP</p>
<pre><code>$ tcpdump -vvAs0 port 123
</code></pre>
<h3 id="capturando-senhas-clear-text">capturando senhas clear-text</h3>
<p>Aqui vamos pegar senhas clear-text em diversos protocolos</p>
<pre><code>$ tcpdump port http or port ftp or port smtp or port imap or port pop3 or port telnet -lA | egrep -i -B5 &#39;pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd= |password=|pass:|user:|username:|password:|login:|pass |user &#39;
</code></pre>
<h3 id="configurando-timestamp-da-captura-de-pacotes">configurando timestamp da captura de pacotes</h3>
<p>Capturando pacotes sem mostrar timestamp</p>
<pre><code>$ tcpdump -i en0 -t
</code></pre>
<p>Capturando pacotes com timestamp com nano-resolution</p>
<pre><code>$ tcpdump --time-stamp-precision nano
</code></pre>
<p>Capturando pacotes com timestamp em formato unix epoc (seconds since January 1, 1970)</p>
<pre><code>$ tcpdump -tt
</code></pre>
<p>Capturando pacotes com timestamp usando horas, minutos, segundos e microsegundos</p>
<pre><code>$ tcpdump -tttt
</code></pre>
<h3 id="configurando-nível-de-ruído-na-captura-de-pacotes">configurando nível de ruído na captura de pacotes</h3>
<p>Mostrando menos detalhes (quite mode)</p>
<pre><code>$ tcpdump -i en0 -q
</code></pre>
<p>Modo verboso inicial</p>
<pre><code>$ tcpdump -i en0 -v
</code></pre>
<p>Modo um pouco mais verboso</p>
<pre><code>$ tcpdump -i en0 -vv
</code></pre>
<p>Modo mais verboso possível no tcpdump</p>
<pre><code>$ tcpdump -i en0 -vvv
</code></pre>
<h3 id="configurando-os-formatos-de-saída-da-captura">configurando os formatos de saída da captura</h3>
<p>Definindo a saída em formato ASCII</p>
<pre><code>$ tcpdump -i en0 -A
</code></pre>
<p>Definindo a saída em formato HEX</p>
<pre><code>$ tcpdump -i en0 -x
</code></pre>
<h3 id="tcpdump-colorido-tem-como">tcpdump colorido, tem como?</h3>
<p>Dá para fazer, vamos instalar o CCZE para ajudar</p>
<pre><code>$ brew install ccze
</code></pre>
<p>Agora vamos usar ele assim</p>
<pre><code>$ tpcdump -i en0 | ccze -A
</code></pre>
<p>Pronto, saída colorida bem fácil de ler!</p>
<h3 id="quer-saber-mais">quer saber mais?</h3>
<p>Para saber mais veja o help do comando</p>
<pre><code>$ tcpdump --help
</code></pre>
<p>Para ir além acesse a manpage</p>
<pre><code>$ man tcpdump
</code></pre>
<h3 id="qual-o-meu-comando-do-dia-a-dia">qual o meu comando do dia a dia?</h3>
<p>Use essa combinação para ver uma saída bastante verbosa, sem resolução de nomes ou portas e mostrando timestamp o mais human-readble possível.</p>
<pre><code>$ tcpdump -ttttnnvvS
</code></pre>
<h2 id="amarrando-as-pontas">Amarrando as pontas</h2>
<p>Esse post é uma tentativa de dar um norte ou um caminho para fazer um bom troubleshooting de redes usando o tcpdump.</p>
<p>Volte aqui sempre que precisar :)</p>
<h2 id="aquele-abraço">Aquele abraço!</h2>
<p>Mando aquele abraço para o professor MESTRE Ulysses Almeida (@ulyssesalmeida) que me ensinou a usar o TCPDUMP lá no início do século.</p>
<p>Mando aquele abraço pro @gomex e @badtux que via exemplo me fazem contribuir mais e mais e mais :)</p>
<p>Mando aquele abraço para todos que leram, comentaram, revisaram e contribuiram de alguma forma com esse post!</p>
<hr>
<p>Este post é do tipo #Mindnodes, entenda <a href="https://gutocarvalho.net/o-que-sao-mindnotes/">aqui</a>.</p>
<p>Se gostou manda um alo no twitter <a href="https://twitter.com/gutocarvalho">@gutocarvalho</a> ou deixa um comentário bacana :)</p>
<h3 id="refs">Refs</h3>
<ul>
<li><a href="https://www.tcpdump.org">https://www.tcpdump.org</a></li>
<li><a href="https://jvns.ca/tcpdump-zine.pdf">https://jvns.ca/tcpdump-zine.pdf</a></li>
<li><a href="https://danielmiessler.com/study/tcpdump/">https://danielmiessler.com/study/tcpdump/</a></li>
<li><a href="https://packetlife.net/media/library/12/tcpdump.pdf">https://packetlife.net/media/library/12/tcpdump.pdf</a></li>
<li><a href="https://www.xmodulo.com/tcpdump-cheat-sheet-examples.html">https://www.xmodulo.com/tcpdump-cheat-sheet-examples.html</a></li>
<li><a href="https://www.comparitech.com/net-admin/tcpdump-cheat-sheet">https://www.comparitech.com/net-admin/tcpdump-cheat-sheet</a></li>
<li><a href="https://blog.wains.be/2007/2007-10-01-tcpdump-advanced-filters">https://blog.wains.be/2007/2007-10-01-tcpdump-advanced-filters</a></li>
<li><a href="https://gist.github.com/jforge/27962c52223ea9b8003b22b8189d93fb">https://gist.github.com/jforge/27962c52223ea9b8003b22b8189d93fb</a></li>
</ul>
<p>[s]<br>
Guto</p>

            ]]>
        </content>
    </entry>
    <entry>
        <title>Conheça o projeto Docker OSX</title>
        <author>
            <name>Guto Carvalho</name>
        </author>
        <link href="https://gutocarvalho.net/conheca-o-projeto-docker-osx/"/>
        <id>https://gutocarvalho.net/conheca-o-projeto-docker-osx/</id>
            <category term="MindNotes"/>

        <updated>2022-03-12T22:36:59-03:00</updated>
            <summary>
                <![CDATA[
                    <p>Já pensou em rodar o OSX via Docker e se conectar no ambiente?</p>

                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <p>Já pensou em rodar o OSX via Docker e se conectar no ambiente?</p>

<p>Pois é, tem um projeto que oferece isso com performance quase nativa, basta executar a imagem e se conectar via X11-Forwarding.<br><br>Conheça!<br><br>- <a href="https://github.com/sickcodes/Docker-OSX">https://github.com/sickcodes/Docker-OSX</a><br><br>[s]<br>Guto</p>
            ]]>
        </content>
    </entry>
</feed>
